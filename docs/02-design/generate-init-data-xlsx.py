#!/usr/bin/env python3
"""
FEV Master Data Initial Seed Generator
=======================================
Generates: docs/02-design/fev-master-data-init.xlsx

Usage:
    pip install openpyxl
    python docs/02-design/generate-init-data-xlsx.py

9 Sheets (MST_ tables):
    1. TAX_TYPE        - 세목 마스터 (7건)
    2. FORM_CODE       - 서식코드 마스터 (~70건)
    3. VALIDATION_RULE  - 검증 규칙 (~140건)
    4. TAX_RATE         - 세율표 (~25건)
    5. DEDUCTION_LIMIT  - 공제/감면 한도표 (34건)
    6. CODE             - 공통코드 (~67건)
    7. ERROR_CODE       - 오류코드 (~66건)
    8. RECORD_LAYOUT    - 레코드 레이아웃 (~70건)
    9. FIELD_LAYOUT     - 필드 레이아웃 (~20건 샘플)

Data Sources:
    - docs/01-plan/glossary.md
    - docs/01-plan/schema.md
    - docs/01-plan/features/tax-file-error-validation.plan.md
    - refer-doc/전자신고_파일오류검증_핵심기능_요구사항.md
"""
import os
import sys

def main():
    try:
        from openpyxl import Workbook
        from openpyxl.styles import Font, PatternFill, Alignment, Border, Side
    except ImportError:
        print("ERROR: openpyxl not installed.")
        print("  pip install openpyxl")
        sys.exit(1)

    wb = Workbook()

    # =========================================================================
    # Sheet 1: MST_TAX_TYPE (세목 마스터)
    # =========================================================================
    TAX_TYPE_HEADERS = [
        'TAX_TYPE_CD', 'TAX_TYPE_NM', 'TAX_TYPE_NM_EN',
        'FILE_EXT', 'ENCODING', 'SORT_ORDER', 'USE_YN'
    ]
    TAX_TYPE_DATA = [
        ('VAT', '부가가치세', 'Value Added Tax', '.101,.102', 'EUC-KR', 1, 'Y'),
        ('CIT', '법인세', 'Corporate Income Tax', '.201', 'EUC-KR', 2, 'Y'),
        ('INC', '종합소득세', 'Individual Income Tax', '.301', 'EUC-KR', 3, 'Y'),
        ('WHT', '원천세', 'Withholding Tax', '.401', 'EUC-KR', 4, 'Y'),
        ('CGT', '양도소득세', 'Capital Gains Tax', '.501', 'EUC-KR', 5, 'Y'),
        ('GFT', '증여세', 'Gift Tax', '.601', 'EUC-KR', 6, 'N'),
        ('INH', '상속세', 'Inheritance Tax', '.701', 'EUC-KR', 7, 'N'),
    ]

    # =========================================================================
    # Sheet 2: MST_FORM_CODE (서식코드 마스터)
    # =========================================================================
    FORM_CODE_HEADERS = [
        'FORM_CD', 'TAX_TYPE_CD', 'FORM_NM', 'RECORD_TYPE',
        'REQUIRED_YN', 'REQUIRED_COND', 'APPLY_START_DT', 'APPLY_END_DT', 'USE_YN'
    ]
    # Helper: (cd, tax, name, rec, req, cond)
    D = '2024-01-01'
    FORM_CODE_DATA = [
        # --- VAT 일반과세자 (V101xxx) ---
        ('V101000', 'VAT', '부가가치세 헤더 레코드 (일반)', 'A', 'Y', None, D, None, 'Y'),
        ('V101001', 'VAT', '부가가치세 신고서 (일반과세자)', 'B', 'Y', None, D, None, 'Y'),
        ('V101011', 'VAT', '매출처별 세금계산서합계표(갑)', 'C', 'C', '해당시', D, None, 'Y'),
        ('V101012', 'VAT', '매출처별 세금계산서합계표(을)', 'D', 'C', '해당시', D, None, 'Y'),
        ('V101021', 'VAT', '매입처별 세금계산서합계표(갑)', 'E', 'C', '해당시', D, None, 'Y'),
        ('V101022', 'VAT', '매입처별 세금계산서합계표(을)', 'F', 'C', '해당시', D, None, 'Y'),
        ('V101031', 'VAT', '매출처별 계산서합계표(갑)-면세', 'G', 'C', '면세겸업시', D, None, 'Y'),
        ('V101032', 'VAT', '매출처별 계산서합계표(을)-면세', 'H', 'C', '면세겸업시', D, None, 'Y'),
        ('V101041', 'VAT', '매입처별 계산서합계표(갑)-면세', 'I', 'C', '면세겸업시', D, None, 'Y'),
        ('V101042', 'VAT', '매입처별 계산서합계표(을)-면세', 'J', 'C', '면세겸업시', D, None, 'Y'),
        ('V101051', 'VAT', '신용카드매출전표등수령명세서(갑)', 'K', 'C', '해당시', D, None, 'Y'),
        ('V101052', 'VAT', '신용카드매출전표등수령명세서(을)', 'L', 'C', '해당시', D, None, 'Y'),
        ('V101061', 'VAT', '의제매입세액공제신고서', 'M', 'C', '해당시', D, None, 'Y'),
        ('V101071', 'VAT', '건물등감가상각자산취득명세서', 'N', 'C', '해당시', D, None, 'Y'),
        ('V101081', 'VAT', '대손세액공제(변제)신고서', 'O', 'C', '해당시', D, None, 'Y'),
        ('V101091', 'VAT', '영세율첨부서류제출명세서', 'P', 'C', '영세율시', D, None, 'Y'),
        ('V101101', 'VAT', '수출실적명세서', 'Q', 'C', '수출시', D, None, 'Y'),
        ('V101111', 'VAT', '공통매입세액안분계산명세서', 'R', 'C', '겸업시', D, None, 'Y'),
        ('V101121', 'VAT', '부동산임대공급가액명세서', 'S', 'C', '부동산임대시', D, None, 'Y'),
        ('V101131', 'VAT', '현금매출명세서', 'T', 'C', '해당시', D, None, 'Y'),
        ('V101141', 'VAT', '총괄납부 사업장별 명세서', 'U', 'C', '총괄납부시', D, None, 'Y'),
        ('V101999', 'VAT', '부가가치세 트레일러 (일반)', 'Z', 'Y', None, D, None, 'Y'),
        # --- VAT 간이과세자 (V102xxx) ---
        ('V102000', 'VAT', '부가가치세 헤더 레코드 (간이)', 'A', 'Y', None, D, None, 'Y'),
        ('V102001', 'VAT', '간이과세자 부가가치세 신고서', 'B', 'Y', None, D, None, 'Y'),
        ('V102999', 'VAT', '부가가치세 트레일러 (간이)', 'Z', 'Y', None, D, None, 'Y'),
        # --- CIT 법인세-1 (CIT01xx) ---
        ('CIT0100', 'CIT', '법인세-1 헤더 레코드', 'A', 'Y', None, D, None, 'Y'),
        ('CIT0101', 'CIT', '과세표준 및 세액신고서', 'B', 'Y', None, D, None, 'Y'),
        ('CIT0102', 'CIT', '세무조정계산서', 'C', 'Y', None, D, None, 'Y'),
        ('CIT0103', 'CIT', '소득금액조정합계표', 'D', 'Y', None, D, None, 'Y'),
        ('CIT0110', 'CIT', '자본금과 적립금 조정명세서(갑)', 'F', 'Y', None, D, None, 'Y'),
        ('CIT0111', 'CIT', '자본금과 적립금 조정명세서(을)', 'G', 'C', '해당시', D, None, 'Y'),
        ('CIT0120', 'CIT', '기부금 명세서', 'H', 'C', '해당시', D, None, 'Y'),
        ('CIT0130', 'CIT', '접대비 조정명세서(갑)', 'J', 'C', '해당시', D, None, 'Y'),
        ('CIT0140', 'CIT', '감가상각비 조정명세서(갑)', 'L', 'C', '해당시', D, None, 'Y'),
        ('CIT0150', 'CIT', '대손충당금 조정명세서', 'O', 'C', '해당시', D, None, 'Y'),
        ('CIT0190', 'CIT', '세액공제 조정명세서', 'S', 'C', '해당시', D, None, 'Y'),
        ('CIT0191', 'CIT', '최저한세 조정명세서', 'T', 'C', '해당시', D, None, 'Y'),
        ('CIT0199', 'CIT', '법인세-1 트레일러', 'Z', 'Y', None, D, None, 'Y'),
        # --- CIT 법인세-2 (CIT02xx) ---
        ('CIT0200', 'CIT', '법인세-2 헤더 레코드', 'A', 'Y', None, D, None, 'Y'),
        ('CIT0201', 'CIT', '재무상태표 (대차대조표)', 'B', 'Y', None, D, None, 'Y'),
        ('CIT0202', 'CIT', '손익계산서', 'C', 'Y', None, D, None, 'Y'),
        ('CIT0203', 'CIT', '이익잉여금처분계산서', 'D', 'Y', None, D, None, 'Y'),
        ('CIT0204', 'CIT', '현금흐름표', 'E', 'C', '해당시', D, None, 'Y'),
        ('CIT0205', 'CIT', '자본변동표', 'F', 'C', '해당시', D, None, 'Y'),
        ('CIT0210', 'CIT', '원가명세서', 'G', 'C', '해당시', D, None, 'Y'),
        ('CIT0240', 'CIT', '주식등변동상황명세서', 'J', 'C', '해당시', D, None, 'Y'),
        ('CIT0260', 'CIT', '특수관계자간거래명세서', 'L', 'C', '해당시', D, None, 'Y'),
        ('CIT0299', 'CIT', '법인세-2 트레일러 레코드', 'Z', 'Y', None, D, None, 'Y'),
        # --- INC 종합소득세 (INC01xx) ---
        ('INC0100', 'INC', '종합소득세 헤더 레코드', 'A', 'Y', None, D, None, 'Y'),
        ('INC0101', 'INC', '종합소득세 과세표준확정신고서', 'B', 'Y', None, D, None, 'Y'),
        ('INC0102', 'INC', '소득금액계산명세서 (사업소득)', 'C', 'C', '사업소득시', D, None, 'Y'),
        ('INC0103', 'INC', '소득금액계산명세서 (부동산임대)', 'D', 'C', '부동산임대시', D, None, 'Y'),
        ('INC0104', 'INC', '소득금액계산명세서 (기타소득)', 'E', 'C', '기타소득시', D, None, 'Y'),
        ('INC0105', 'INC', '인적공제명세서', 'F', 'Y', None, D, None, 'Y'),
        ('INC0106', 'INC', '소득공제명세서 (연금/저축 등)', 'G', 'C', '해당시', D, None, 'Y'),
        ('INC0107', 'INC', '특별소득공제명세서', 'H', 'C', '해당시', D, None, 'Y'),
        ('INC0108', 'INC', '세액공제명세서', 'I', 'C', '해당시', D, None, 'Y'),
        ('INC0109', 'INC', '기납부세액명세서', 'J', 'C', '해당시', D, None, 'Y'),
        ('INC0110', 'INC', '추계소득금액계산서 (경비율 적용)', 'K', 'C', '무기장시', D, None, 'Y'),
        ('INC0111', 'INC', '성실신고확인서', 'L', 'C', '수입5억이상', D, None, 'Y'),
        ('INC0199', 'INC', '종합소득세 트레일러 레코드', 'Z', 'Y', None, D, None, 'Y'),
        # --- WHT 원천세 (A304xxx) ---
        ('A304000', 'WHT', '원천세 헤더 레코드', 'A', 'Y', None, D, None, 'Y'),
        ('A304100', 'WHT', '원천징수이행상황신고서', 'B', 'Y', None, D, None, 'Y'),
        ('A304200', 'WHT', '근로소득 지급명세서', 'C', 'C', '해당시', D, None, 'Y'),
        ('A304300', 'WHT', '사업소득 지급명세서', 'D', 'C', '해당시', D, None, 'Y'),
        ('A304400', 'WHT', '기타소득 지급명세서', 'E', 'C', '해당시', D, None, 'Y'),
        ('A304500', 'WHT', '퇴직소득 지급명세서', 'F', 'C', '해당시', D, None, 'Y'),
        ('A304600', 'WHT', '일용근로소득 지급명세서', 'G', 'C', '해당시', D, None, 'Y'),
        ('A304700', 'WHT', '이자/배당소득 지급명세서', 'H', 'C', '해당시', D, None, 'Y'),
        ('A304800', 'WHT', '연금소득 지급명세서', 'I', 'C', '해당시', D, None, 'Y'),
        ('A304900', 'WHT', '비거주자 소득 지급명세서', 'J', 'C', '해당시', D, None, 'Y'),
        ('A305000', 'WHT', '종교인소득 지급명세서', 'K', 'C', '해당시', D, None, 'Y'),
        ('A305099', 'WHT', '원천세 트레일러 레코드', 'Z', 'Y', None, D, None, 'Y'),
        # --- CGT 양도소득세 (CGT01xx) ---
        ('CGT0100', 'CGT', '양도소득세 헤더 레코드', 'A', 'Y', None, D, None, 'Y'),
        ('CGT0101', 'CGT', '양도소득세 과세표준 신고서', 'B', 'Y', None, D, None, 'Y'),
        ('CGT0102', 'CGT', '양도소득금액 계산명세서', 'C', 'Y', None, D, None, 'Y'),
        ('CGT0199', 'CGT', '양도소득세 트레일러 레코드', 'Z', 'Y', None, D, None, 'Y'),
    ]

    # =========================================================================
    # Sheet 3: MST_VALIDATION_RULE (검증 규칙 마스터)
    # =========================================================================
    RULE_HEADERS = [
        'RULE_ID', 'TAX_TYPE_CD', 'RULE_NM', 'RULE_LEVEL', 'SEVERITY',
        'RULE_FORMULA', 'LEGAL_BASIS', 'PENALTY_REF', 'ERROR_MSG',
        'FIX_GUIDE', 'APPLY_START_DT', 'APPLY_END_DT', 'USE_YN'
    ]
    # Helper shortcut
    def R(rid, tax, nm, lv, sev, formula, legal, penalty, msg, fix):
        return (rid, tax, nm, lv, sev, formula, legal, penalty, msg, fix, D, None, 'Y')

    RULE_DATA = [
        # ---- VAT L1 Format ----
        R('VAT-F001', 'VAT', '파일 확장자 검증', 1, 'FATAL',
          'FILE_EXT in (.101, .102)', None, None,
          '파일 확장자가 .101/.102이 아닙니다', '부가세 파일 확장자를 확인하세요'),
        R('VAT-F002', 'VAT', '레코드 길이 검증', 1, 'FATAL',
          'LEN(record) == LAYOUT.RECORD_LEN', None, None,
          '레코드 길이 오류 (기대:{expected}, 실제:{actual})', '레코드 길이를 규격에 맞게 수정하세요'),
        R('VAT-F003', 'VAT', '숫자 필드 타입 검증', 1, 'FATAL',
          'FIELD.type==N => MATCH(^[0-9]+$)', None, None,
          '숫자 필드에 문자 포함', '숫자 필드에서 문자를 제거하세요'),
        R('VAT-F004', 'VAT', '필드 길이 검증', 1, 'FATAL',
          'LEN(field_bytes) == LAYOUT.FIELD_LEN', None, None,
          '필드 값이 지정 바이트 범위를 초과합니다', '필드 길이를 규격에 맞게 조정하세요'),
        R('VAT-F005', 'VAT', '코드값 유효성 검증', 1, 'FATAL',
          'FIELD.value IN VALID_VALUES', None, None,
          '허용되지 않는 코드값입니다 ({actual})', '허용 코드표를 참조하여 수정하세요'),
        R('VAT-F006', 'VAT', '날짜 형식 검증', 1, 'FATAL',
          'MATCH(YYYYMMDD) AND VALID_DATE', None, None,
          '날짜 형식 오류 ({actual})', 'YYYYMMDD 형식의 유효한 날짜를 입력하세요'),
        R('VAT-F007', 'VAT', '패딩 규칙 검증', 1, 'WARNING',
          'C:RIGHT_SPACE, N:LEFT_ZERO', None, None,
          '패딩 규칙 위반 (문자:우측공백, 숫자:좌측0)', '필드 타입에 맞는 패딩을 적용하세요'),
        # ---- VAT L2 Structure ----
        R('VAT-S001', 'VAT', 'A/B/Z 레코드 존재 검증', 2, 'FATAL',
          'EXISTS(A) AND EXISTS(B) AND EXISTS(Z)', None, None,
          'A/B/Z 레코드 누락', '필수 레코드(A, B, Z)를 포함하세요'),
        R('VAT-S002', 'VAT', '레코드 순서 검증', 2, 'FATAL',
          'ORDER: A -> B~Y -> Z', None, None,
          '레코드 순서 오류', '레코드를 A→B~Y→Z 순서로 배치하세요'),
        R('VAT-S003', 'VAT', 'Z레코드 건수 일치', 2, 'FATAL',
          'Z.record_count == ACTUAL_COUNT', None, None,
          'Z레코드 건수 불일치', 'Z레코드의 총건수를 실제 레코드수와 일치시키세요'),
        R('VAT-S004', 'VAT', 'A/B 사업자번호 일치', 2, 'FATAL',
          'A.BRN == B.BRN', None, None,
          'A/B 레코드 사업자번호 불일치', 'A레코드와 B레코드의 사업자번호를 일치시키세요'),
        R('VAT-S005', 'VAT', '합계표 갑/을지 쌍 일치', 2, 'ERROR',
          'EXISTS(갑) => EXISTS(을)', None, None,
          '합계표 갑/을지 쌍 불일치', '갑지가 있으면 을지도 함께 제출하세요'),
        R('VAT-S006', 'VAT', '필수 레코드 존재 검증', 2, 'FATAL',
          'REQUIRED_RECORDS ALL EXISTS', None, None,
          '세목별 필수 레코드 누락', '필수 레코드를 확인하여 추가하세요'),
        R('VAT-S007', 'VAT', '필수 항목 존재 검증', 2, 'FATAL',
          'MANDATORY_FIELDS NOT EMPTY', None, None,
          '필수 항목(M) 값 누락', '필수 입력 항목의 값을 입력하세요'),
        # ---- VAT L3 Content ----
        R('VAT-C001', 'VAT', '과세 매출세액 계산 검증', 3, 'ERROR',
          '매출세액 == 과세표준 * 0.10', '부가가치세법 제30조', '과소신고가산세 10%',
          '매출세액 불일치 (파일:{actual}, 계산:{expected})', '매출세액 = 과세표준 x 10%로 수정하세요'),
        R('VAT-C002', 'VAT', '영세율 매출세액 검증', 3, 'ERROR',
          '영세율_세액 == 0', '부가가치세법 제11조', None,
          '영세율 매출 세액이 0이 아닙니다', '영세율 매출의 세액을 0으로 수정하세요'),
        R('VAT-C003', 'VAT', '과세표준 합계 검증', 3, 'ERROR',
          '합계 == SUM(세금계산서+신용카드+기타+영세율)', None, None,
          '과세표준 합계 불일치', '각 유형별 과세표준의 합계를 확인하세요'),
        R('VAT-C004', 'VAT', '매출세액 합계 검증', 3, 'ERROR',
          '합계 == SUM(각 유형별 세액)', None, None,
          '매출세액 합계 불일치', '각 유형별 세액의 합계를 확인하세요'),
        R('VAT-C005', 'VAT', '과세표준 단수처리 검증', 3, 'WARNING',
          '과세표준 % 1000 == 0', '국세기본법 제50조', None,
          '과세표준 1,000원 미만 미절사', '과세표준에서 1,000원 미만을 절사하세요'),
        R('VAT-C010', 'VAT', '매입세액 합계 검증', 3, 'ERROR',
          '공제매입세액 == SUM(일반+고정+예정누락+기타)', '부가가치세법 제37조', None,
          '공제받을매입세액 합계 불일치', '매입세액 각 항목의 합계를 확인하세요'),
        R('VAT-C011', 'VAT', '불공제 매입세액 검증', 3, 'ERROR',
          'CHECK(접대비, 비영업용승용차)', '부가가치세법 제39조', None,
          '불공제 매입세액 항목 오류', '접대비/비영업용 승용차 매입세액 불공제를 확인하세요'),
        R('VAT-C012', 'VAT', '개별 세금계산서 세액', 3, 'ERROR',
          '세액 == 공급가액 * 0.10', None, None,
          '개별 세금계산서 세액 불일치', '세액 = 공급가액 x 10%를 확인하세요'),
        R('VAT-C013', 'VAT', '토지 관련 매입세액 불공제', 3, 'ERROR',
          'CHECK(토지취득/자본적지출)', '부가가치세법 제39조①④', None,
          '토지 관련 매입세액 공제 오류', '토지 취득/자본적 지출 매입세액은 불공제입니다'),
        R('VAT-C030', 'VAT', '안분비율 계산 검증', 3, 'ERROR',
          '면세비율 == 면세공급가액/(과세+면세)', '부가가치세법 제40조', None,
          '공통매입세액 안분비율 계산 오류', '면세비율 = 면세공급가액 / 총공급가액'),
        R('VAT-C031', 'VAT', '불공제세액 계산 검증', 3, 'ERROR',
          '불공제세액 == 공통매입세액 * 면세비율', None, None,
          '공통매입세액 불공제세액 계산 오류', '불공제세액 = 공통매입세액 x 면세비율'),
        R('VAT-C032', 'VAT', '5% 미만 면세비율 전액공제', 3, 'WARNING',
          '면세비율 < 5% => 전액공제가능', '시행령 제81조', None,
          '면세비율 5% 미만 시 전액공제 가능', '면세비율이 5% 미만이면 전액공제 가능합니다'),
        R('VAT-C050', 'VAT', '납부(환급)세액 계산', 3, 'ERROR',
          '납부세액 == 매출세액 - 공제매입세액 + 불공제', None, None,
          '납부(환급)세액 계산 오류', '납부세액 = 매출세액 - 매입세액 + 불공제로 수정'),
        R('VAT-C051', 'VAT', '차가감납부세액 계산', 3, 'ERROR',
          '차가감 == 납부 - 경감 - 예정미환급 - 예정고지 - 기납부', None, None,
          '차가감납부세액 계산 오류', '차가감납부세액 산식을 확인하세요'),
        R('VAT-C052', 'VAT', '신용카드발행공제 한도', 3, 'WARNING',
          '공제액 <= 연1000만원', None, None,
          '신용카드발행공제 한도 초과', '연간 한도 1,000만원 이내로 조정하세요'),
        R('VAT-C053', 'VAT', '전자세금계산서발급공제', 3, 'WARNING',
          '공제액 <= 연100만원 (건당200원)', None, None,
          '전자세금계산서발급공제 한도 초과', '연간 한도 100만원 이내로 조정하세요'),
        R('VAT-C060', 'VAT', '사업자등록번호 체크디지트', 3, 'FATAL',
          'BRN_CHECK_DIGIT(BRN)', None, None,
          '사업자등록번호 체크디지트 오류', '사업자등록번호를 확인하세요'),
        R('VAT-C061', 'VAT', '주민등록번호 체크디지트', 3, 'FATAL',
          'RRN_CHECK_DIGIT(RRN)', None, None,
          '주민등록번호 체크디지트 오류', '주민등록번호를 확인하세요'),
        # ---- VAT L4 Logic ----
        R('VAT-L001', 'VAT', '매출합계표↔신고서 과세표준', 4, 'ERROR',
          'C.총공급가액 == B.세금계산서발급분_과세표준', None, None,
          '매출합계표와 신고서 금액 불일치', '매출합계표(갑)과 신고서 과세표준을 일치시키세요'),
        R('VAT-L002', 'VAT', '매출합계표↔신고서 세액', 4, 'ERROR',
          'C.총세액 == B.세금계산서발급분_세액', None, None,
          '매출합계표와 신고서 세액 불일치', '매출합계표(갑)과 신고서 세액을 일치시키세요'),
        R('VAT-L003', 'VAT', '매입합계표↔신고서 과세표준', 4, 'ERROR',
          'E.총공급가액 == B.세금계산서수취분_과세표준', None, None,
          '매입합계표와 신고서 금액 불일치', '매입합계표(갑)과 신고서 과세표준을 일치시키세요'),
        R('VAT-L004', 'VAT', '매입합계표↔신고서 세액', 4, 'ERROR',
          'E.총세액 == B.세금계산서수취분_세액', None, None,
          '매입합계표와 신고서 세액 불일치', '매입합계표(갑)과 신고서 세액을 일치시키세요'),
        R('VAT-L005', 'VAT', '갑지↔을지 매수 일치', 4, 'ERROR',
          '갑지_총매수 == SUM(을지_매수)', None, None,
          '갑지/을지 매수 합계 불일치', '갑지 매수와 을지 합계를 일치시키세요'),
        R('VAT-L006', 'VAT', '갑지↔을지 공급가액 일치', 4, 'ERROR',
          '갑지_총공급가액 == SUM(을지_공급가액)', None, None,
          '갑지/을지 공급가액 불일치', '갑지 공급가액과 을지 합계를 일치시키세요'),
        R('VAT-L007', 'VAT', '갑지↔을지 세액 일치', 4, 'ERROR',
          '갑지_총세액 == SUM(을지_세액)', None, None,
          '갑지/을지 세액 불일치', '갑지 세액과 을지 합계를 일치시키세요'),
        R('VAT-L008', 'VAT', '전자+종이=총합계', 4, 'ERROR',
          '전자세금계산서 + 종이세금계산서 == 총합계', None, None,
          '전자/종이 세금계산서 합계 불일치', '전자+종이 세금계산서 합계를 확인하세요'),
        # ---- VAT L5 Regulatory ----
        R('VAT-R001', 'VAT', '과세매출 영세율 적용 오류', 5, 'ERROR',
          'CHECK(영세율_요건)', '부가가치세법 제11조', None,
          '과세 매출에 영세율 적용', '영세율 적용 요건을 확인하세요'),
        R('VAT-R002', 'VAT', '간이과세 부가가치율 오적용', 5, 'ERROR',
          'CHECK(업종별_부가가치율)', '부가가치세법 제61조', None,
          '간이과세 부가가치율 오적용', '업종별 부가가치율을 확인하세요'),
        R('VAT-R003', 'VAT', '신용카드발행공제 한도 초과', 5, 'WARNING',
          '공제액 <= 연간한도', None, None,
          '신용카드발행공제 한도 초과', '연간 공제한도를 확인하세요'),
        R('VAT-R004', 'VAT', '대손세액공제 기간 초과', 5, 'ERROR',
          '대손확정일 - 공급일 <= 5년', '부가가치세법 제45조', None,
          '대손세액공제 기간(5년) 초과', '대손세액공제는 공급일로부터 5년 이내만 가능'),
        # ---- CIT L1 Format ----
        R('CIT-F001', 'CIT', '파일 확장자 검증', 1, 'FATAL',
          'FILE_EXT == .201', None, None,
          '파일 확장자가 .201이 아닙니다', '법인세 파일 확장자를 .201로 확인'),
        R('CIT-F002', 'CIT', '레코드 길이 검증', 1, 'FATAL',
          'LEN(record) == LAYOUT.RECORD_LEN', None, None,
          '레코드 길이 오류', '레코드 길이를 규격에 맞게 수정'),
        R('CIT-F003', 'CIT', '숫자 필드 타입 검증', 1, 'FATAL',
          'FIELD.type==N => MATCH(^[0-9]+$)', None, None,
          '숫자 필드에 문자 포함', '숫자 필드에서 문자를 제거하세요'),
        # ---- CIT L2 Structure ----
        R('CIT-S001', 'CIT', 'A/B/Z 레코드 존재 검증', 2, 'FATAL',
          'EXISTS(A) AND EXISTS(B) AND EXISTS(Z)', None, None,
          'A/B/Z 레코드 누락', '필수 레코드(A, B, Z)를 포함하세요'),
        R('CIT-S002', 'CIT', 'Z레코드 건수 일치', 2, 'FATAL',
          'Z.record_count == ACTUAL_COUNT', None, None,
          'Z레코드 건수 불일치', 'Z레코드의 총건수를 일치시키세요'),
        R('CIT-S003', 'CIT', '사업자번호 레코드간 일치', 2, 'FATAL',
          'A.BRN == B.BRN', None, None,
          'A/B 레코드 사업자번호 불일치', '사업자번호를 일치시키세요'),
        # ---- CIT L3 Content ----
        R('CIT-C001', 'CIT', '당기순이익 일치 검증', 3, 'FATAL',
          'CIT2.손익계산서.당기순이익 == CIT1.세무조정.결산서상_당기순이익',
          '법인세법 시행규칙 별지 제3호', None,
          '당기순이익 불일치 (법인세-1 vs 법인세-2)', '법인세-1과 법인세-2의 당기순이익을 일치시키세요'),
        R('CIT-C002', 'CIT', '소득금액 계산 검증', 3, 'ERROR',
          '소득금액 == 당기순이익 + 익금산입 + 손금불산입 - 손금산입 - 익금불산입',
          '법인세법 제14조', '과소신고가산세 10%',
          '소득금액 계산 오류', '소득금액 = 당기순이익 + 세무조정 합계로 수정'),
        R('CIT-C003', 'CIT', '과세표준 계산 검증', 3, 'ERROR',
          '과세표준 == 소득금액 - 이월결손금 - 비과세소득',
          '법인세법 제13조', None,
          '과세표준 계산 오류', '과세표준 = 소득금액 - 이월결손금 - 비과세소득'),
        R('CIT-C004', 'CIT', '산출세액 계산 검증', 3, 'ERROR',
          '산출세액 == 과세표준별_누진세율_적용',
          '법인세법 제55조', '과소신고가산세 10%',
          '산출세액 계산 오류', '과세표준 구간별 세율을 정확히 적용하세요'),
        R('CIT-C005', 'CIT', '총결정세액 검증', 3, 'ERROR',
          '총결정세액 == 산출세액 - 공제감면 + 가산세', None, None,
          '총결정세액 계산 오류', '산출세액 - 공제감면 + 가산세를 확인하세요'),
        R('CIT-C006', 'CIT', '차감납부세액 검증', 3, 'ERROR',
          '차감납부세액 == 총결정세액 - 기납부세액', None, None,
          '차감납부세액 계산 오류', '총결정세액 - 기납부세액을 확인하세요'),
        R('CIT-C007', 'CIT', '이월결손금 한도 검증', 3, 'ERROR',
          '일반: 소득x60%, 중소기업: 100%', '법인세법 제13조', None,
          '이월결손금 공제한도 초과', '법인 유형별 이월결손금 한도를 확인하세요'),
        R('CIT-C008', 'CIT', '이월결손금 기간 검증', 3, 'ERROR',
          '15년(2020이후), 10년(2009~2019), 5년(2008이전)', None, None,
          '이월결손금 공제기간 초과', '발생연도별 이월결손금 공제기간을 확인하세요'),
        R('CIT-C009', 'CIT', '최저한세 검증', 3, 'ERROR',
          '감면후세액 >= 과세표준 * 최저한세율', '조특법 제132조', None,
          '최저한세 미달', '감면 적용 후에도 최저한세 이상 납부해야 합니다'),
        R('CIT-C010', 'CIT', '지방소득세 검증', 3, 'ERROR',
          '지방소득세 == 법인세 * 0.10', '지방세법 제103조의20', None,
          '지방소득세 계산 오류', '지방소득세 = 법인세 x 10%'),
        # ---- CIT L4 Logic ----
        R('CIT-L001', 'CIT', '접대비 한도 검증', 4, 'ERROR',
          '접대비 <= 기본한도 + 수입금액기준한도', '법인세법 제25조', None,
          '접대비 한도 초과', '접대비 기본한도 + 수입금액별 적용률을 확인하세요'),
        R('CIT-L002', 'CIT', '기부금 한도 검증', 4, 'ERROR',
          '법정:(소득-결손금)x50%, 지정:(소득-결손금-법정)x10%',
          '법인세법 제24조', None,
          '기부금 공제한도 초과', '법정/지정 기부금 한도를 확인하세요'),
        R('CIT-L003', 'CIT', '감가상각비 검증', 4, 'ERROR',
          '상각부인액 == MAX(0, 회사계상액-상각범위액)', '법인세법 제23조', None,
          '감가상각비 상각부인액 계산 오류', '상각범위액과 회사계상액을 비교하세요'),
        R('CIT-L004', 'CIT', '대손충당금 한도 검증', 4, 'ERROR',
          '한도 == 채권잔액 * MAX(대손실적률, 1%)', '법인세법 제34조', None,
          '대손충당금 한도 초과', '채권잔액 x MAX(대손실적률, 1%) 한도 확인'),
        R('CIT-L005', 'CIT', '자본금적립금 연속성', 4, 'ERROR',
          '기말잔액 == 기초 + 증가 - 감소', None, None,
          '자본금과적립금 기말잔액 불일치', '기초+증가-감소 = 기말 확인'),
        R('CIT-L006', 'CIT', '소득처분 반영 검증', 4, 'ERROR',
          '소득금액조정합계표 == SUM(부속명세서_조정액)', None, None,
          '소득처분 합계 불일치', '각 부속명세서 조정액 합계를 확인하세요'),
        # ---- CIT2 재무제표 검증 ----
        R('CIT2-E001', 'CIT', '재무상태표 대차균형', 3, 'FATAL',
          '자산총계 == 부채총계 + 자본총계', None, None,
          '재무상태표 대차균형 오류', '자산총계 = 부채총계 + 자본총계'),
        R('CIT2-E002', 'CIT', '유동자산 합계 검증', 3, 'ERROR',
          '유동자산합계 == SUM(세부계정)', None, None,
          '유동자산 합계 불일치', '유동자산 세부계정 합계를 확인하세요'),
        R('CIT2-E003', 'CIT', '비유동자산 합계 검증', 3, 'ERROR',
          '비유동자산합계 == SUM(세부계정)', None, None,
          '비유동자산 합계 불일치', '비유동자산 세부계정 합계를 확인하세요'),
        R('CIT2-E010', 'CIT', '매출총이익 검증', 3, 'ERROR',
          '매출총이익 == 매출액 - 매출원가', None, None,
          '매출총이익 계산 오류', '매출총이익 = 매출액 - 매출원가'),
        R('CIT2-E011', 'CIT', '영업이익 검증', 3, 'ERROR',
          '영업이익 == 매출총이익 - 판관비', None, None,
          '영업이익 계산 오류', '영업이익 = 매출총이익 - 판매비와관리비'),
        R('CIT2-E012', 'CIT', '법인세비용차감전순이익', 3, 'ERROR',
          '== 영업이익 + 영업외수익 - 영업외비용', None, None,
          '법인세비용차감전순이익 계산 오류', '영업이익 + 영업외수익 - 영업외비용'),
        R('CIT2-E013', 'CIT', '당기순이익 검증', 3, 'FATAL',
          '당기순이익 == 법인세비용차감전 - 법인세비용', None, None,
          '당기순이익 계산 오류', '법인세비용차감전순이익 - 법인세비용'),
        R('CIT2-E020', 'CIT', '당기순이익 교차 검증', 4, 'FATAL',
          'CIT2.당기순이익 == CIT1.결산서상_당기순이익', None, None,
          '법인세-2/1 당기순이익 교차 불일치', '법인세-2와 법인세-1의 당기순이익을 일치시키세요'),
        R('CIT2-E021', 'CIT', '감가상각비 연결 검증', 4, 'ERROR',
          'CIT1.회사계상액 == 손익계산서.감가상각비', None, None,
          '법인세-1/2 감가상각비 불일치', '세무조정 회사계상액과 손익계산서를 일치시키세요'),
        R('CIT2-E023', 'CIT', '이익잉여금 연결 검증', 4, 'ERROR',
          '재무상태표.이익잉여금 == 이익잉여금처분계산서', None, None,
          '이익잉여금 교차 불일치', '재무상태표와 이익잉여금처분계산서를 일치시키세요'),
        R('CIT2-E030', 'CIT', '현금흐름표 검증', 3, 'WARNING',
          '기초현금 + 영업 + 투자 + 재무 == 기말현금', None, None,
          '현금흐름표 기말현금 불일치', '영업/투자/재무 활동 현금흐름 합계 확인'),
        R('CIT2-E040', 'CIT', '전기 연속성 검증', 4, 'WARNING',
          '당기_전기금액 == 전기_당기금액', None, None,
          '전기 금액 연속성 오류', '당기 재무제표의 전기금액을 확인하세요'),
        # ---- INC L1 Format ----
        R('INC-F001', 'INC', '파일 확장자 검증', 1, 'FATAL',
          'FILE_EXT == .301', None, None,
          '파일 확장자가 .301이 아닙니다', '종합소득세 파일 확장자를 .301로 확인'),
        R('INC-F002', 'INC', '레코드 길이 검증', 1, 'FATAL',
          'LEN(record) == LAYOUT.RECORD_LEN', None, None,
          '레코드 길이 오류', '레코드 길이를 규격에 맞게 수정'),
        R('INC-F003', 'INC', '숫자 필드 타입 검증', 1, 'FATAL',
          'FIELD.type==N => MATCH(^[0-9]+$)', None, None,
          '숫자 필드에 문자 포함', '숫자 필드에서 문자를 제거하세요'),
        # ---- INC L2 Structure ----
        R('INC-S001', 'INC', 'A/B/Z 레코드 존재 검증', 2, 'FATAL',
          'EXISTS(A) AND EXISTS(B) AND EXISTS(Z)', None, None,
          'A/B/Z 레코드 누락', '필수 레코드(A, B, Z)를 포함하세요'),
        R('INC-S002', 'INC', 'Z레코드 건수 일치', 2, 'FATAL',
          'Z.record_count == ACTUAL_COUNT', None, None,
          'Z레코드 건수 불일치', 'Z레코드의 총건수를 일치시키세요'),
        R('INC-S003', 'INC', '사업자번호 레코드간 일치', 2, 'FATAL',
          'A.BRN == B.BRN', None, None,
          'A/B 레코드 사업자번호/주민번호 불일치', '사업자번호/주민번호를 일치시키세요'),
        # ---- INC L3 Content ----
        R('INC-C001', 'INC', '소득합산 검증', 3, 'ERROR',
          '종합소득금액 == 이자+배당+사업+근로+연금+기타', None, None,
          '종합소득금액 합산 오류', '각 소득유형의 합계를 확인하세요'),
        R('INC-C002', 'INC', '과세표준 계산 검증', 3, 'ERROR',
          '과세표준 == 종합소득금액 - 소득공제합계 (1000원미만 절사)',
          '소득세법 제14조', '과소신고가산세 10%',
          '과세표준 계산 오류', '과세표준 = 종합소득금액 - 소득공제 (절사)'),
        R('INC-C003', 'INC', '산출세액 계산 검증', 3, 'ERROR',
          '산출세액 == 과세표준 * 세율 - 누진공제', '소득세법 제55조', None,
          '산출세액 계산 오류', '8단계 누진세율을 정확히 적용하세요'),
        R('INC-C004', 'INC', '결정세액 검증', 3, 'ERROR',
          '결정세액 == 산출세액 - 세액공제합계', None, None,
          '결정세액 계산 오류', '산출세액 - 세액공제합계를 확인하세요'),
        R('INC-C005', 'INC', '납부세액 검증', 3, 'ERROR',
          '납부세액 == 총결정세액 - 기납부세액', None, None,
          '납부세액 계산 오류', '총결정세액 - 기납부세액을 확인하세요'),
        R('INC-C006', 'INC', '지방소득세 검증', 3, 'ERROR',
          '지방소득세 == 납부세액 * 0.10', '지방세법 제91조', None,
          '지방소득세 계산 오류', '지방소득세 = 소득세 x 10%'),
        # ---- INC L4 Logic ----
        R('INC-L001', 'INC', '인적공제 소득요건', 4, 'ERROR',
          '부양가족 소득금액 <= 100만원', '소득세법 제50조', None,
          '인적공제 대상 소득요건 초과', '부양가족 연소득 100만원 이하 확인'),
        R('INC-L002', 'INC', '인적공제 연령요건', 4, 'ERROR',
          '직계존속 60세이상, 직계비속 20세이하', '소득세법 제50조', None,
          '인적공제 대상 연령요건 미충족', '직계존속/비속 연령요건을 확인하세요'),
        R('INC-L003', 'INC', '부녀자/한부모 중복 검증', 4, 'ERROR',
          'NOT(부녀자 AND 한부모)', '소득세법 제51조', None,
          '부녀자/한부모공제 중복 적용', '부녀자와 한부모공제는 중복 불가 (한부모 우선)'),
        R('INC-L004', 'INC', '신용카드 공제한도 검증', 4, 'ERROR',
          '총급여 구간별 한도 이내', '조특법 제126조의2', None,
          '신용카드 소득공제 한도 초과', '총급여 구간별 공제한도를 확인하세요'),
        R('INC-L005', 'INC', '소득공제 종합한도 검증', 4, 'ERROR',
          '소득공제합계 <= 2500만원', '조특법 제132조의2', None,
          '소득공제 종합한도(2,500만원) 초과', '소득공제 종합한도를 확인하세요'),
        R('INC-L006', 'INC', '사업소득 교차 검증', 4, 'ERROR',
          'B.사업소득 == C.합계', None, None,
          'B레코드 사업소득과 C레코드 합계 불일치', '사업소득 금액을 일치시키세요'),
        R('INC-L007', 'INC', '경비율 적용 검증', 4, 'ERROR',
          '업종코드별 고시 경비율 일치', None, None,
          '경비율 적용 오류', '업종코드별 기준/단순 경비율을 확인하세요'),
        R('INC-L008', 'INC', '금융소득 종합과세 검증', 4, 'WARNING',
          '이자+배당 > 2000만원 => 종합과세', '소득세법 제14조', None,
          '금융소득 종합과세 대상', '이자+배당 2,000만원 초과 시 종합과세'),
        R('INC-L009', 'INC', '기장의무 확인', 4, 'WARNING',
          'CHECK(수입금액_기준_복식부기의무)', '소득세법 제160조', None,
          '복식부기의무자 확인 필요', '수입금액 기준 기장의무를 확인하세요'),
        R('INC-L010', 'INC', '성실신고확인 필요', 4, 'WARNING',
          '수입금액 >= 5억 => 확인서 필수', '소득세법 제70조의2', None,
          '성실신고확인서 미제출', '수입금액 5억 이상 시 성실신고확인서 필수'),
        # ---- INC L5 Regulatory ----
        R('INC-T001', 'INC', '세율구간 적용 검증', 5, 'ERROR',
          'CHECK(과세표준_대비_적용세율)', '소득세법 제55조', None,
          '세율구간 오적용', '과세표준에 해당하는 세율구간을 확인하세요'),
        R('INC-T002', 'INC', '의료비 공제한도 검증', 5, 'ERROR',
          '의료비공제 <= 700만원', '조특법 제122조의3', None,
          '의료비 세액공제 한도 초과', '의료비 세액공제 700만원 한도 확인'),
        R('INC-T003', 'INC', '교육비 공제한도 검증', 5, 'ERROR',
          'CHECK(교육비_법정한도)', '소득세법 제59조의4', None,
          '교육비 세액공제 한도 초과', '법정 교육비 한도를 확인하세요'),
        R('INC-T004', 'INC', '표준/특별세액공제 중복', 5, 'ERROR',
          'NOT(표준세액공제 AND 특별세액공제)', '소득세법 제59조의4', None,
          '표준/특별세액공제 동시 적용', '표준세액공제와 특별세액공제는 중복 불가'),
        R('INC-T005', 'INC', '월세공제 소득요건', 5, 'ERROR',
          '총급여 <= 8000만원', '조특법 제95조의2', None,
          '월세 세액공제 소득요건 초과', '총급여 8,000만원 초과 시 월세공제 불가'),
        # ---- WHT L1 Format ----
        R('WHT-F001', 'WHT', '파일 확장자 검증', 1, 'FATAL',
          'FILE_EXT == .401', None, None,
          '파일 확장자가 .401이 아닙니다', '원천세 파일 확장자를 .401로 확인'),
        R('WHT-F002', 'WHT', '레코드 길이 규격 검증', 1, 'FATAL',
          'LEN(record) == LAYOUT.RECORD_LEN', None, None,
          '레코드 길이 규격 불일치', '레코드 길이를 규격에 맞게 수정하세요'),
        R('WHT-F003', 'WHT', '숫자 필드 타입 검증', 1, 'FATAL',
          'FIELD.type==N => NUMERIC_ONLY', None, None,
          '숫자 필드에 문자 포함', '숫자 필드에서 문자를 제거하세요'),
        # ---- WHT L2 Structure ----
        R('WHT-S001', 'WHT', 'Z레코드 건수 일치', 2, 'FATAL',
          'Z.count == ACTUAL_COUNT', None, None,
          'Z레코드 건수 불일치', 'Z레코드 총건수를 실제 레코드수와 일치'),
        R('WHT-S002', 'WHT', '필수 레코드 존재', 2, 'FATAL',
          'EXISTS(A,B,Z)', None, None,
          '필수 레코드 누락', '필수 레코드(A, B, Z)를 포함하세요'),
        R('WHT-S003', 'WHT', '사업자번호 레코드간 일치', 2, 'FATAL',
          'A.BRN == B.BRN == others.BRN', None, None,
          '사업자번호 레코드간 불일치', '모든 레코드의 사업자번호를 일치시키세요'),
        # ---- WHT L3 Content ----
        R('WHT-C001', 'WHT', '근로소득 소계 검증', 3, 'ERROR',
          'A09 == A01+A02+A03+A04 (인원/지급액/소득세/지방세)', None, None,
          '소득종류별 소계 불일치 (근로소득)', '근로소득 소계(A09) 합산을 확인하세요'),
        R('WHT-C002', 'WHT', '사업소득 소계 검증', 3, 'ERROR',
          'A29 == A20+A21+A22+A25+A26', None, None,
          '사업소득 소계 불일치', '사업소득 소계(A29) 합산을 확인하세요'),
        R('WHT-C003', 'WHT', '금융소득 소계 검증', 3, 'ERROR',
          'A49 == A40+A41+A42', None, None,
          '금융소득 소계 불일치', '금융소득 소계(A49) 합산을 확인하세요'),
        R('WHT-C004', 'WHT', '기타소득 소계 검증', 3, 'ERROR',
          'A69 == A30+A50+A60', None, None,
          '기타소득 소계 불일치', '기타소득 소계(A69) 합산을 확인하세요'),
        R('WHT-C005', 'WHT', '비거주자 소계 검증', 3, 'ERROR',
          'A80 == SUM(A70~A79)', None, None,
          '비거주자 소계 불일치', '비거주자 소계(A80) 합산을 확인하세요'),
        R('WHT-C006', 'WHT', '가감계 검증', 3, 'ERROR',
          'A90 == A09+A10+A29+A49+A69+A80', None, None,
          '가감계(A90) 합산 오류', '가감계 합산을 확인하세요'),
        R('WHT-C007', 'WHT', '최종합계 검증', 3, 'ERROR',
          'A99 == A90', None, None,
          '합계(A99) 오류', '최종합계(A99)를 확인하세요'),
        R('WHT-C008', 'WHT', '지방소득세 검증', 3, 'ERROR',
          '각항목_지방소득세 == 소득세 * 0.10', None, None,
          '지방소득세 = 소득세x10% 불일치', '각 항목의 지방소득세를 확인하세요'),
        R('WHT-C009', 'WHT', '납부세액 계산 검증', 3, 'ERROR',
          'A99.소득세 - 조정환급 - 전월미환급이월', None, None,
          '납부세액 계산 오류', '납부세액 산식을 확인하세요'),
        # ---- WHT L4 Logic ----
        R('WHT-L001', 'WHT', '근로소득 인원 교차검증', 4, 'ERROR',
          'B.A01_인원 == C레코드_건수', None, None,
          '신고서 인원 vs 지급명세서 건수 불일치 (근로)', '근로소득 인원수를 일치시키세요'),
        R('WHT-L002', 'WHT', '일용근로 인원 교차검증', 4, 'ERROR',
          'B.A03_인원 == G레코드_건수', None, None,
          '신고서 인원 vs 지급명세서 건수 불일치 (일용)', '일용근로 인원수를 일치시키세요'),
        R('WHT-L003', 'WHT', '사업소득 인원 교차검증', 4, 'ERROR',
          'B.A20_인원 == D레코드_건수', None, None,
          '신고서 인원 vs 지급명세서 건수 불일치 (사업)', '사업소득 인원수를 일치시키세요'),
        R('WHT-L004', 'WHT', '기타소득 인원 교차검증', 4, 'ERROR',
          'B.A30_인원 == E레코드_건수', None, None,
          '신고서 인원 vs 지급명세서 건수 불일치 (기타)', '기타소득 인원수를 일치시키세요'),
        R('WHT-L005', 'WHT', '퇴직소득 인원 교차검증', 4, 'ERROR',
          'B.A10_인원 == F레코드_건수', None, None,
          '신고서 인원 vs 지급명세서 건수 불일치 (퇴직)', '퇴직소득 인원수를 일치시키세요'),
        R('WHT-L006', 'WHT', '총지급액 교차검증', 4, 'ERROR',
          'B.총지급액 == SUM(지급명세서_합계)', None, None,
          '신고서 총지급액 vs 지급명세서 합계 불일치', '총지급액 합계를 일치시키세요'),
        # ---- WHT 연말정산 (Y) ----
        R('WHT-Y001', 'WHT', '근로소득공제 검증', 4, 'ERROR',
          'CHECK(총급여_구간별_공제율)', '소득세법 제47조', None,
          '근로소득공제 계산 오류', '총급여 구간별 공제율을 확인하세요'),
        R('WHT-Y002', 'WHT', '소득공제 한도 검증', 4, 'ERROR',
          'CHECK(항목별_법정한도)', None, None,
          '소득공제 법정한도 초과', '각 항목별 법정한도를 확인하세요'),
        R('WHT-Y003', 'WHT', '세액공제 한도 검증', 4, 'ERROR',
          'CHECK(항목별_법정한도)', None, None,
          '세액공제 법정한도 초과', '각 항목별 법정한도를 확인하세요'),
        R('WHT-Y004', 'WHT', '결정세액 검증', 4, 'ERROR',
          '결정세액 == 산출세액 - 세액공제합계', None, None,
          '연말정산 결정세액 계산 오류', '결정세액 = 산출세액 - 세액공제합계'),
        R('WHT-Y005', 'WHT', '차감징수세액 검증', 4, 'ERROR',
          '차감징수세액 == 결정세액 - 기납부세액', None, None,
          '차감징수세액 계산 오류', '차감징수세액 = 결정세액 - 기납부세액'),
        R('WHT-Y006', 'WHT', '비과세소득 합계 검증', 4, 'ERROR',
          '비과세합계 == SUM(비과세항목)', None, None,
          '비과세소득 합계 불일치', '비과세소득 개별항목 합계를 확인하세요'),
        # ---- WHT L5 Regulatory ----
        R('WHT-W001', 'WHT', '일용근로 비과세 확인', 5, 'WARNING',
          '일급여 <= 150000 => 세액=0', '소득세법 제47조', None,
          '일용근로 일급여 15만원 이하 세액=0 확인', '일급여 15만원 이하 비과세 확인'),
        R('WHT-W002', 'WHT', '사업소득 세율 확인', 5, 'WARNING',
          '원천징수세율 == 3%', '소득세법 제129조', None,
          '사업소득 3% 미적용 건 존재', '사업소득 원천징수세율 3% 적용 확인'),
        R('WHT-W003', 'WHT', '기타소득 필요경비율 확인', 5, 'WARNING',
          'CHECK(필요경비율)', '소득세법 제37조', None,
          '기타소득 필요경비율 비정상', '기타소득 필요경비율(일반 60%)을 확인하세요'),
        # ---- CGT L1 Format ----
        R('CGT-F001', 'CGT', '파일 확장자 검증', 1, 'FATAL',
          'FILE_EXT == .501', None, None,
          '파일 확장자가 .501이 아닙니다', '양도소득세 파일 확장자를 .501로 확인'),
        R('CGT-F002', 'CGT', '레코드 길이 검증', 1, 'FATAL',
          'LEN(record) == LAYOUT.RECORD_LEN', None, None,
          '레코드 길이 오류', '레코드 길이를 규격에 맞게 수정'),
        # ---- CGT L2 Structure ----
        R('CGT-S001', 'CGT', 'A/B/Z 레코드 존재 검증', 2, 'FATAL',
          'EXISTS(A) AND EXISTS(B) AND EXISTS(Z)', None, None,
          'A/B/Z 레코드 누락', '필수 레코드(A, B, Z)를 포함하세요'),
        R('CGT-S002', 'CGT', 'Z레코드 건수 일치', 2, 'FATAL',
          'Z.record_count == ACTUAL_COUNT', None, None,
          'Z레코드 건수 불일치', 'Z레코드의 총건수를 일치시키세요'),
        # ---- CGT L3~L5 양도소득세 ----
        R('CGT-C001', 'CGT', '양도차익 계산', 3, 'ERROR',
          '양도차익 == 양도가액 - 취득가액 - 필요경비', '소득세법 제95조', None,
          '양도차익 계산 오류', '양도차익 = 양도가액 - 취득가액 - 필요경비'),
        R('CGT-C002', 'CGT', '장기보유특별공제율 검증', 3, 'ERROR',
          'CHECK(보유기간별_공제율)', '소득세법 제95조', None,
          '장기보유특별공제율 오적용', '보유기간별 공제율을 확인하세요'),
        R('CGT-C003', 'CGT', '보유기간 계산 검증', 3, 'ERROR',
          '보유기간 == 양도일 - 취득일', '소득세법 제95조', None,
          '보유기간 계산 오류', '취득일~양도일 기간을 확인하세요'),
        R('CGT-C004', 'CGT', '1세대1주택 비과세 요건', 5, 'WARNING',
          'CHECK(보유2년, 거주2년, 12억이하)', '소득세법 제89조', None,
          '1세대1주택 비과세 요건 확인', '보유/거주기간 및 양도가액을 확인하세요'),
        R('CGT-C005', 'CGT', '중과세율 적용 검증', 5, 'ERROR',
          'CHECK(1년미만70%, 1~2년60%, 다주택중과)', '소득세법 제104조', None,
          '양도소득세 중과세율 적용 오류', '보유기간별/다주택 중과세율을 확인하세요'),
        R('CGT-C006', 'CGT', '기본공제 검증', 3, 'ERROR',
          '기본공제 <= 250만원', '소득세법 제103조', None,
          '양도소득 기본공제 초과', '연간 기본공제 250만원 한도를 확인하세요'),
        R('CGT-C007', 'CGT', '누진세율 적용 검증', 3, 'ERROR',
          'CHECK(8단계_누진세율)', '소득세법 제104조', None,
          '양도소득세 누진세율 오적용', '8단계 누진세율을 정확히 적용하세요'),
    ]

    # =========================================================================
    # Sheet 4: MST_TAX_RATE (세율표)
    # =========================================================================
    RATE_HEADERS = [
        'RATE_ID', 'TAX_TYPE_CD', 'TAX_YEAR', 'BRACKET_SEQ', 'BASE_FROM',
        'BASE_TO', 'RATE_PERCENT', 'DEDUCTION_AMT', 'DESCRIPTION'
    ]
    RATE_DATA = [
        # VAT 기본세율
        ('VAT', '2025', 1, 0, None, 10.00, 0, '부가가치세 기본세율 10%'),
        # CIT 법인세율 (4구간)
        ('CIT', '2025', 1, 0, 200000000, 9.00, 0, '2억원 이하'),
        ('CIT', '2025', 2, 200000001, 20000000000, 19.00, 20000000, '2억~200억'),
        ('CIT', '2025', 3, 20000000001, 300000000000, 21.00, 420000000, '200억~3,000억'),
        ('CIT', '2025', 4, 300000000001, None, 24.00, 9420000000, '3,000억 초과'),
        # CIT 최저한세율
        ('CIT', '2025', 11, 0, None, 7.00, 0, '최저한세-중소기업'),
        ('CIT', '2025', 12, 0, 10000000000, 10.00, 0, '최저한세-100억 이하(일반)'),
        ('CIT', '2025', 13, 10000000001, 100000000000, 12.00, 0, '최저한세-100억~1,000억'),
        ('CIT', '2025', 14, 100000000001, None, 17.00, 0, '최저한세-1,000억 초과'),
        # INC 종합소득세 8단계 누진세율
        ('INC', '2025', 1, 0, 14000000, 6.00, 0, '1,400만원 이하'),
        ('INC', '2025', 2, 14000001, 50000000, 15.00, 1260000, '1,400만~5,000만'),
        ('INC', '2025', 3, 50000001, 88000000, 24.00, 5760000, '5,000만~8,800만'),
        ('INC', '2025', 4, 88000001, 150000000, 35.00, 15440000, '8,800만~1.5억'),
        ('INC', '2025', 5, 150000001, 300000000, 38.00, 19940000, '1.5억~3억'),
        ('INC', '2025', 6, 300000001, 500000000, 40.00, 25940000, '3억~5억'),
        ('INC', '2025', 7, 500000001, 1000000000, 42.00, 35940000, '5억~10억'),
        ('INC', '2025', 8, 1000000001, None, 45.00, 65940000, '10억 초과'),
        # CGT 양도소득세 특별세율
        ('CGT', '2025', 1, 0, None, 70.00, 0, '주택/분양권 1년미만 보유'),
        ('CGT', '2025', 2, 0, None, 60.00, 0, '주택/분양권 1~2년 보유'),
        ('CGT', '2025', 3, 0, None, 20.00, 0, '중소기업 주식 (10억 이하)'),
        ('CGT', '2025', 4, 10000000001, None, 25.00, 0, '중소기업 주식 (10억 초과)'),
        ('CGT', '2025', 5, 0, 300000000, 22.00, 0, '기타 주식 (3억 이하)'),
        ('CGT', '2025', 6, 300000001, None, 27.50, 0, '기타 주식 (3억 초과)'),
    ]
    # Prepend RATE_ID (AUTO_INCREMENT PK)
    RATE_DATA = [(i + 1,) + row for i, row in enumerate(RATE_DATA)]

    # =========================================================================
    # Sheet 5: MST_DEDUCTION_LIMIT (공제/감면 한도표)
    # =========================================================================
    DED_HEADERS = [
        'LIMIT_ID', 'TAX_TYPE_CD', 'TAX_YEAR', 'DEDUCTION_CD', 'DEDUCTION_NM',
        'LIMIT_AMT', 'LIMIT_RATE', 'CONDITION_DESC', 'LEGAL_BASIS'
    ]
    DED_DATA = [
        # VAT 공제한도 (10건)
        ('VAT', '2025', 'VAT-DED-001', '신용카드발행공제(일반)', 10000000, 1.30, '일반사업자', None),
        ('VAT', '2025', 'VAT-DED-002', '신용카드발행공제(음식/숙박)', 10000000, 2.60, '음식점/숙박업', None),
        ('VAT', '2025', 'VAT-DED-003', '전자세금계산서발급공제', 1000000, None, '건당200원, 개인사업자', None),
        ('VAT', '2025', 'VAT-DED-004', '의제매입세액(음식점 개인 2억이하)', None, 8.26, '9/109', '부가가치세법 제42조'),
        ('VAT', '2025', 'VAT-DED-005', '의제매입세액(음식점 개인 2억초과)', None, 7.41, '8/108', '부가가치세법 제42조'),
        ('VAT', '2025', 'VAT-DED-006', '의제매입세액(음식점 법인)', None, 5.66, '6/106', '부가가치세법 제42조'),
        ('VAT', '2025', 'VAT-DED-007', '의제매입세액(제조업 개인 중소)', None, 3.85, '4/104', '부가가치세법 제42조'),
        ('VAT', '2025', 'VAT-DED-008', '의제매입세액(제조업 법인 중소)', None, 2.91, '3/103', '부가가치세법 제42조'),
        ('VAT', '2025', 'VAT-DED-009', '의제매입세액(과세유흥/기타)', None, 1.96, '2/102', '부가가치세법 제42조'),
        ('VAT', '2025', 'VAT-DED-010', '대손세액공제 기간한도', None, None, '공급일로부터 5년 이내', '부가가치세법 제45조'),
        # CIT 공제한도 (7건)
        ('CIT', '2025', 'CIT-DED-001', '접대비 기본한도(중소기업)', 36000000, None, '중소기업', '법인세법 제25조'),
        ('CIT', '2025', 'CIT-DED-002', '접대비 기본한도(일반)', 12000000, None, '일반법인', '법인세법 제25조'),
        ('CIT', '2025', 'CIT-DED-003', '기부금(법정) 공제한도', None, 50.00, '(소득-결손금)x50%', '법인세법 제24조'),
        ('CIT', '2025', 'CIT-DED-004', '기부금(지정) 공제한도', None, 10.00, '(소득-결손금-법정)x10%', '법인세법 제24조'),
        ('CIT', '2025', 'CIT-DED-005', '이월결손금(일반)', None, 60.00, '소득금액x60%', '법인세법 제13조'),
        ('CIT', '2025', 'CIT-DED-006', '이월결손금(중소기업)', None, 100.00, '소득금액x100%', '법인세법 제13조'),
        ('CIT', '2025', 'CIT-DED-007', '대손충당금 설정한도', None, 1.00, 'MAX(대손실적률,1%)', '법인세법 제34조'),
        # INC 공제한도 (17건)
        ('INC', '2025', 'INC-DED-001', '인적공제-본인', 1500000, None, '항상 적용', '소득세법 제50조'),
        ('INC', '2025', 'INC-DED-002', '인적공제-배우자', 1500000, None, '소득100만이하', '소득세법 제50조'),
        ('INC', '2025', 'INC-DED-003', '인적공제-직계존속', 1500000, None, '60세이상+소득100만이하', '소득세법 제50조'),
        ('INC', '2025', 'INC-DED-004', '인적공제-직계비속', 1500000, None, '20세이하+소득100만이하', '소득세법 제50조'),
        ('INC', '2025', 'INC-DED-005', '추가공제-경로우대', 1000000, None, '70세 이상', '소득세법 제51조'),
        ('INC', '2025', 'INC-DED-006', '추가공제-장애인', 2000000, None, '기본공제 대상 장애인', '소득세법 제51조'),
        ('INC', '2025', 'INC-DED-007', '추가공제-부녀자', 500000, None, '종합소득3천만이하 여성', '소득세법 제51조'),
        ('INC', '2025', 'INC-DED-008', '추가공제-한부모', 1000000, None, '배우자없이 직계비속', '소득세법 제51조'),
        ('INC', '2025', 'INC-DED-009', '소득공제 종합한도', 25000000, None, '신용카드/주택마련/투자조합 등', '조특법 제132조의2'),
        ('INC', '2025', 'INC-DED-010', '자녀세액공제(1인)', 150000, None, '2인:30만, 3인~:+30만/인', '소득세법 제59조의2'),
        ('INC', '2025', 'INC-DED-011', '연금계좌세액공제 한도', 9000000, None, '12%(5,500만이하 15%)', '소득세법 제59조의3'),
        ('INC', '2025', 'INC-DED-012', '보험료세액공제 한도', 1000000, 12.00, '연 100만원', '소득세법 제59조의4'),
        ('INC', '2025', 'INC-DED-013', '의료비세액공제 한도', 7000000, 15.00, '총급여3%초과분', '소득세법 제59조의4'),
        ('INC', '2025', 'INC-DED-014', '교육비세액공제(대학)', 9000000, 15.00, '본인:무한도', '소득세법 제59조의4'),
        ('INC', '2025', 'INC-DED-015', '월세세액공제 한도', 10000000, None, '17%(5,500만이하)/15%', '조특법 제95조의2'),
        ('INC', '2025', 'INC-DED-016', '표준세액공제(근로자)', 130000, None, '근로소득자', '소득세법 제59조의4'),
        ('INC', '2025', 'INC-DED-017', '표준세액공제(기타)', 70000, None, '근로소득 외', '소득세법 제59조의4'),
    ]
    # Prepend LIMIT_ID (AUTO_INCREMENT PK)
    DED_DATA = [(i + 1,) + row for i, row in enumerate(DED_DATA)]

    # =========================================================================
    # Sheet 6: MST_CODE (공통코드)
    # =========================================================================
    CODE_HEADERS = [
        'CODE_GRP', 'CODE_CD', 'CODE_NM', 'CODE_NM_EN',
        'CODE_DESC', 'SORT_ORDER', 'PARENT_CD', 'USE_YN'
    ]
    CODE_DATA = [
        # SEVERITY (4건)
        ('SEVERITY', 'FATAL', '치명적', 'Fatal', '파일 구조 자체 오류, 후속검증 불가', 1, None, 'Y'),
        ('SEVERITY', 'ERROR', '오류', 'Error', '세액/합계 불일치, 수정 필수', 2, None, 'Y'),
        ('SEVERITY', 'WARNING', '경고', 'Warning', '패딩 오류 등, 선택적 수정 권고', 3, None, 'Y'),
        ('SEVERITY', 'INFO', '정보', 'Info', '참고 사항, 수정 불필요', 4, None, 'Y'),
        # RULE_LEVEL (5건)
        ('RULE_LEVEL', '1', '형식검증', 'Format Validation', 'L1: 파일포맷/필드길이/데이터타입', 1, None, 'Y'),
        ('RULE_LEVEL', '2', '구조검증', 'Structural Validation', 'L2: 레코드존재/순서/건수/필수항목', 2, None, 'Y'),
        ('RULE_LEVEL', '3', '내용검증', 'Content Validation', 'L3: 체크디지트/합계/세액계산', 3, None, 'Y'),
        ('RULE_LEVEL', '4', '논리검증', 'Logic Validation', 'L4: 서식간교차/기간정합성', 4, None, 'Y'),
        ('RULE_LEVEL', '5', '법규검증', 'Regulatory Validation', 'L5: 세율/공제한도/비과세요건', 5, None, 'Y'),
        # RPT_TYPE (4건)
        ('RPT_TYPE', '01', '정기신고', 'Regular Filing', None, 1, None, 'Y'),
        ('RPT_TYPE', '02', '수정신고', 'Amended Filing', None, 2, None, 'Y'),
        ('RPT_TYPE', '03', '기한후신고', 'Late Filing', None, 3, None, 'Y'),
        ('RPT_TYPE', '04', '경정청구', 'Claim for Correction', None, 4, None, 'Y'),
        # TAX_PERIOD (4건 - 부가세)
        ('TAX_PERIOD', '01', '1기 예정', 'Q1 Preliminary', '1~3월', 1, None, 'Y'),
        ('TAX_PERIOD', '02', '1기 확정', 'Q1 Final', '1~6월', 2, None, 'Y'),
        ('TAX_PERIOD', '03', '2기 예정', 'Q2 Preliminary', '7~9월', 3, None, 'Y'),
        ('TAX_PERIOD', '04', '2기 확정', 'Q2 Final', '7~12월', 4, None, 'Y'),
        # CORP_TYPE (5건)
        ('CORP_TYPE', '01', '내국영리법인', 'Domestic For-Profit', None, 1, None, 'Y'),
        ('CORP_TYPE', '02', '내국비영리법인', 'Domestic Non-Profit', None, 2, None, 'Y'),
        ('CORP_TYPE', '03', '외국영리법인', 'Foreign For-Profit', None, 3, None, 'Y'),
        ('CORP_TYPE', '04', '외국비영리법인', 'Foreign Non-Profit', None, 4, None, 'Y'),
        ('CORP_TYPE', '05', '조합법인', 'Cooperative', None, 5, None, 'Y'),
        # BAD_DEBT (5건)
        ('BAD_DEBT', '01', '부도발생(6개월 경과)', 'Default (6mo+)', None, 1, None, 'Y'),
        ('BAD_DEBT', '02', '강제집행/경매', 'Execution/Auction', None, 2, None, 'Y'),
        ('BAD_DEBT', '03', '채무자 회생/파산', 'Rehabilitation/Bankruptcy', None, 3, None, 'Y'),
        ('BAD_DEBT', '04', '소멸시효 완성', 'Statute of Limitations', None, 4, None, 'Y'),
        ('BAD_DEBT', '05', '회수불능(법원확인)', 'Uncollectible (Court)', None, 5, None, 'Y'),
        # DATA_TYPE (3건)
        ('DATA_TYPE', 'C', '문자', 'Character', '좌측정렬, 우측 공백(0x20) 패딩', 1, None, 'Y'),
        ('DATA_TYPE', 'N', '숫자', 'Numeric', '우측정렬, 좌측 0(0x30) 패딩', 2, None, 'Y'),
        ('DATA_TYPE', 'CN', '혼합', 'Mixed', '좌측정렬, 우측 공백 패딩', 3, None, 'Y'),
        # REQUIRED_TYPE (3건)
        ('REQUIRED_TYPE', 'M', '필수', 'Mandatory', '반드시 값이 존재해야 함', 1, None, 'Y'),
        ('REQUIRED_TYPE', 'C', '조건부', 'Conditional', '특정 조건 시 필수', 2, None, 'Y'),
        ('REQUIRED_TYPE', 'O', '선택', 'Optional', '선택 입력', 3, None, 'Y'),
        # INC_TYPE - 소득종류 (원천세, 17건)
        ('INC_TYPE', 'A01', '근로소득(간이세액)', 'Employment(Simplified)', None, 1, None, 'Y'),
        ('INC_TYPE', 'A02', '근로소득(중도퇴사)', 'Employment(Mid-term)', None, 2, None, 'Y'),
        ('INC_TYPE', 'A03', '일용근로소득', 'Daily Labor', None, 3, None, 'Y'),
        ('INC_TYPE', 'A04', '근로소득(연말정산)', 'Employment(Year-end)', None, 4, None, 'Y'),
        ('INC_TYPE', 'A09', '근로소득 소계', 'Employment Subtotal', None, 5, None, 'Y'),
        ('INC_TYPE', 'A10', '퇴직소득', 'Retirement', None, 6, None, 'Y'),
        ('INC_TYPE', 'A20', '사업소득(일반)', 'Business(General)', None, 7, None, 'Y'),
        ('INC_TYPE', 'A21', '사업소득(연금계좌)', 'Business(Pension)', None, 8, None, 'Y'),
        ('INC_TYPE', 'A22', '봉사료', 'Tips', None, 9, None, 'Y'),
        ('INC_TYPE', 'A25', '사업소득(인적용역)', 'Business(Personal Svc)', None, 10, None, 'Y'),
        ('INC_TYPE', 'A26', '사업소득(봉사료 종합)', 'Business(Tips Total)', None, 11, None, 'Y'),
        ('INC_TYPE', 'A29', '사업소득 소계', 'Business Subtotal', None, 12, None, 'Y'),
        ('INC_TYPE', 'A30', '기타소득', 'Other Income', None, 13, None, 'Y'),
        ('INC_TYPE', 'A40', '이자소득', 'Interest', None, 14, None, 'Y'),
        ('INC_TYPE', 'A41', '배당소득', 'Dividend', None, 15, None, 'Y'),
        ('INC_TYPE', 'A42', '배당소득(집합투자)', 'Dividend(Fund)', None, 16, None, 'Y'),
        ('INC_TYPE', 'A49', '금융소득 소계', 'Financial Subtotal', None, 17, None, 'Y'),
        ('INC_TYPE', 'A50', '연금소득', 'Pension', None, 18, None, 'Y'),
        ('INC_TYPE', 'A60', '기타소득(종교인)', 'Other(Religious)', None, 19, None, 'Y'),
        ('INC_TYPE', 'A69', '기타소득 소계', 'Other Subtotal', None, 20, None, 'Y'),
        ('INC_TYPE', 'A70', '비거주자(근로)', 'Non-resident(Employ)', None, 21, None, 'Y'),
        ('INC_TYPE', 'A71', '비거주자(퇴직)', 'Non-resident(Retire)', None, 22, None, 'Y'),
        ('INC_TYPE', 'A72', '비거주자(사업)', 'Non-resident(Business)', None, 23, None, 'Y'),
        ('INC_TYPE', 'A73', '비거주자(기타)', 'Non-resident(Other)', None, 24, None, 'Y'),
        ('INC_TYPE', 'A79', '비거주자(그외)', 'Non-resident(Misc)', None, 25, None, 'Y'),
        ('INC_TYPE', 'A80', '비거주자 소계', 'Non-resident Subtotal', None, 26, None, 'Y'),
        ('INC_TYPE', 'A90', '가감계', 'Adjustment Total', None, 27, None, 'Y'),
        ('INC_TYPE', 'A99', '합계', 'Grand Total', None, 28, None, 'Y'),
    ]

    # =========================================================================
    # Sheet 7: MST_ERROR_CODE (오류코드 정의)
    # =========================================================================
    ERR_HEADERS = [
        'ERROR_CD', 'RULE_ID', 'ERROR_MSG_TEMPLATE', 'FIX_GUIDE_TEMPLATE',
        'LEGAL_BASIS', 'PENALTY_INFO', 'USE_YN'
    ]
    ERR_DATA = [
        # VAT 오류코드 (23건)
        ('VAT-F001', 'VAT-F001', '파일 확장자가 .101/.102이 아닙니다', '부가세 파일 확장자 확인', None, None, 'Y'),
        ('VAT-F002', 'VAT-F002', '레코드 길이 오류 (기대:{expected}, 실제:{actual})', '레코드 길이 규격 수정', None, None, 'Y'),
        ('VAT-F003', 'VAT-F003', '숫자 필드에 문자 포함', '숫자 필드 문자 제거', None, None, 'Y'),
        ('VAT-S001', 'VAT-S001', 'A/B/Z 레코드 누락', '필수 레코드 추가', None, None, 'Y'),
        ('VAT-S002', 'VAT-S002', '레코드 순서 오류', 'A→B~Y→Z 순서 배치', None, None, 'Y'),
        ('VAT-S003', 'VAT-S003', 'Z레코드 건수 불일치', 'Z레코드 총건수 수정', None, None, 'Y'),
        ('VAT-S004', 'VAT-S004', 'A/B 레코드 사업자번호 불일치', '사업자번호 일치 확인', None, None, 'Y'),
        ('VAT-S005', 'VAT-S005', '합계표 갑/을지 쌍 불일치', '갑지/을지 쌍 확인', None, None, 'Y'),
        ('VAT-C001', 'VAT-C001', '매출세액 불일치 (파일:{actual}, 계산:{expected})', '매출세액=과세표준x10%', '부가가치세법 제30조', '과소신고가산세 10%', 'Y'),
        ('VAT-C002', 'VAT-C002', '영세율 매출 세액이 0이 아닙니다', '영세율 매출 세액 0 확인', '부가가치세법 제11조', None, 'Y'),
        ('VAT-C003', 'VAT-C003', '과세표준 합계 불일치', '각 유형별 과세표준 합계 확인', None, None, 'Y'),
        ('VAT-C010', 'VAT-C010', '공제받을매입세액 합계 불일치', '매입세액 각 항목 합계 확인', '부가가치세법 제37조', None, 'Y'),
        ('VAT-C050', 'VAT-C050', '납부(환급)세액 계산 오류', '납부세액 산식 확인', None, None, 'Y'),
        ('VAT-C060', 'VAT-C060', '사업자등록번호 체크디지트 오류', '사업자번호 확인', None, None, 'Y'),
        ('VAT-L001', 'VAT-L001', '매출합계표와 신고서 금액 불일치', '매출합계표↔신고서 일치', None, None, 'Y'),
        ('VAT-L002', 'VAT-L002', '매출합계표와 신고서 세액 불일치', '매출합계표↔신고서 세액 일치', None, None, 'Y'),
        ('VAT-L003', 'VAT-L003', '매입합계표와 신고서 금액 불일치', '매입합계표↔신고서 일치', None, None, 'Y'),
        ('VAT-L005', 'VAT-L005', '갑지/을지 매수 합계 불일치', '갑지/을지 매수/금액 일치', None, None, 'Y'),
        ('VAT-L004', 'VAT-L008', '전자/종이 세금계산서 합계 불일치', '전자+종이 세금계산서 합계 확인', None, None, 'Y'),
        ('VAT-R001', 'VAT-R001', '과세 매출에 영세율 적용', '영세율 요건 확인', '부가가치세법 제11조', None, 'Y'),
        ('VAT-R002', 'VAT-R002', '간이과세 부가가치율 오적용', '업종별 부가가치율 확인', '부가가치세법 제61조', None, 'Y'),
        ('VAT-R003', 'VAT-R003', '신용카드발행공제 한도 초과', '연간한도 1,000만원 확인', None, None, 'Y'),
        ('VAT-R004', 'VAT-R004', '대손세액공제 기간(5년) 초과', '공급일 기준 5년 확인', '부가가치세법 제45조', None, 'Y'),
        # WHT 오류코드 (25건)
        ('WHT-F001', 'WHT-F001', '파일 확장자가 .401이 아닙니다', '원천세 파일 확장자 .401 확인', None, None, 'Y'),
        ('WHT-F002', 'WHT-F002', '레코드 길이 규격 불일치', '레코드 길이 규격 수정', None, None, 'Y'),
        ('WHT-F003', 'WHT-F003', '숫자 필드에 문자 포함', '숫자 필드 문자 제거', None, None, 'Y'),
        ('WHT-S001', 'WHT-S001', 'Z레코드 건수 불일치', 'Z레코드 총건수 수정', None, None, 'Y'),
        ('WHT-S002', 'WHT-S002', '필수 레코드 누락', '필수 레코드 추가', None, None, 'Y'),
        ('WHT-S003', 'WHT-S003', '사업자번호 레코드간 불일치', '모든 레코드 사업자번호 일치', None, None, 'Y'),
        ('WHT-C001', 'WHT-C001', '근로소득 소계(A09) 불일치', '근로소득 소계 합산 확인', None, None, 'Y'),
        ('WHT-C002', 'WHT-C002', '사업소득 소계(A29) 불일치', '사업소득 소계 합산 확인', None, None, 'Y'),
        ('WHT-C003', 'WHT-C003', '금융소득 소계(A49) 불일치', '금융소득 소계 합산 확인', None, None, 'Y'),
        ('WHT-C004', 'WHT-C004', '기타소득 소계(A69) 불일치', '기타소득 소계 합산 확인', None, None, 'Y'),
        ('WHT-C005', 'WHT-C005', '비거주자 소계(A80) 불일치', '비거주자 소계 합산 확인', None, None, 'Y'),
        ('WHT-C006', 'WHT-C006', '가감계(A90) 합산 오류', '가감계 합산 확인', None, None, 'Y'),
        ('WHT-C007', 'WHT-C007', '합계(A99) 오류', '최종합계 확인', None, None, 'Y'),
        ('WHT-C008', 'WHT-C008', '지방소득세 = 소득세x10% 불일치', '지방소득세 계산 확인', None, None, 'Y'),
        ('WHT-C009', 'WHT-C009', '납부세액 계산 오류', '납부세액 산식 확인', None, None, 'Y'),
        ('WHT-L001', 'WHT-L001', '신고서 인원 vs 지급명세서 건수 불일치 (근로)', '근로소득 인원수 일치 확인', None, None, 'Y'),
        ('WHT-L002', 'WHT-L002', '일용근로 인원 교차검증 불일치', '일용근로 인원수 일치 확인', None, None, 'Y'),
        ('WHT-L003', 'WHT-L003', '사업소득 인원 교차검증 불일치', '사업소득 인원수 일치 확인', None, None, 'Y'),
        ('WHT-L004', 'WHT-L004', '기타소득 인원 교차검증 불일치', '기타소득 인원수 일치 확인', None, None, 'Y'),
        ('WHT-L005', 'WHT-L005', '퇴직소득 인원 교차검증 불일치', '퇴직소득 인원수 일치 확인', None, None, 'Y'),
        ('WHT-L006', 'WHT-L006', '신고서 총지급액 vs 지급명세서 합계 불일치', '총지급액 합계 확인', None, None, 'Y'),
        ('WHT-Y004', 'WHT-Y004', '연말정산 결정세액 계산 오류', '결정세액 산식 확인', None, None, 'Y'),
        ('WHT-W001', 'WHT-W001', '일용근로 일급여 15만원 이하 세액=0 확인', '비과세 한도 확인', '소득세법 제47조', None, 'Y'),
        ('WHT-W002', 'WHT-W002', '사업소득 3% 미적용 건 존재', '원천징수세율 3% 확인', '소득세법 제129조', None, 'Y'),
        ('WHT-W003', 'WHT-W003', '기타소득 필요경비율 비정상', '필요경비율 60% 확인', '소득세법 제37조', None, 'Y'),
        # CIT 오류코드 (8건)
        ('CIT-C001', 'CIT-C001', '당기순이익 불일치 (법인세-1 vs 법인세-2)', '법인세-1/2 당기순이익 일치', '법인세법 시행규칙 별지 제3호', None, 'Y'),
        ('CIT-C002', 'CIT-C002', '소득금액 계산 오류', '소득금액 산식 확인', '법인세법 제14조', '과소신고가산세 10%', 'Y'),
        ('CIT-C004', 'CIT-C004', '산출세액 계산 오류', '누진세율 적용 확인', '법인세법 제55조', '과소신고가산세 10%', 'Y'),
        ('CIT-C009', 'CIT-C009', '최저한세 미달', '최저한세 이상 납부 확인', '조특법 제132조', None, 'Y'),
        ('CIT-L001', 'CIT-L001', '접대비 한도 초과', '접대비 한도 확인', '법인세법 제25조', None, 'Y'),
        ('CIT-L002', 'CIT-L002', '기부금 공제한도 초과', '법정/지정 기부금 한도 확인', '법인세법 제24조', None, 'Y'),
        ('CIT2-E001', 'CIT2-E001', '재무상태표 대차균형 오류', '자산=부채+자본 확인', None, None, 'Y'),
        ('CIT2-E020', 'CIT2-E020', '법인세-2/1 당기순이익 교차 불일치', '법인세-2와 1 당기순이익 일치', None, None, 'Y'),
        # INC 오류코드 (6건)
        ('INC-C002', 'INC-C002', '과세표준 계산 오류', '과세표준 산식 확인', '소득세법 제14조', '과소신고가산세 10%', 'Y'),
        ('INC-C003', 'INC-C003', '산출세액 계산 오류', '8단계 누진세율 확인', '소득세법 제55조', None, 'Y'),
        ('INC-L001', 'INC-L001', '인적공제 대상 소득요건 초과', '부양가족 소득 100만 이하 확인', '소득세법 제50조', None, 'Y'),
        ('INC-L003', 'INC-L003', '부녀자/한부모공제 중복 적용', '중복 불가 확인', '소득세법 제51조', None, 'Y'),
        ('INC-L005', 'INC-L005', '소득공제 종합한도(2,500만원) 초과', '종합한도 확인', '조특법 제132조의2', None, 'Y'),
        ('INC-T004', 'INC-T004', '표준/특별세액공제 동시 적용', '중복 불가 확인', '소득세법 제59조의4', None, 'Y'),
        # CGT 오류코드 (4건)
        ('CGT-C001', 'CGT-C001', '양도차익 계산 오류', '양도차익 산식 확인', '소득세법 제95조', None, 'Y'),
        ('CGT-C005', 'CGT-C005', '양도소득세 중과세율 적용 오류', '중과세율 확인', '소득세법 제104조', None, 'Y'),
        ('CGT-C006', 'CGT-C006', '양도소득 기본공제 초과', '연간 250만원 한도 확인', '소득세법 제103조', None, 'Y'),
        ('CGT-C007', 'CGT-C007', '양도소득세 누진세율 오적용', '8단계 누진세율 확인', '소득세법 제104조', None, 'Y'),
    ]

    # =========================================================================
    # Sheet 8: MST_RECORD_LAYOUT (레코드 레이아웃)
    # =========================================================================
    LAYOUT_HEADERS = [
        'LAYOUT_ID', 'TAX_TYPE_CD', 'FORM_CD', 'RECORD_TYPE', 'RECORD_NM',
        'RECORD_LEN', 'REQUIRED_YN', 'APPLY_START_DT', 'APPLY_END_DT'
    ]
    # Generate from FORM_CODE_DATA (1:1 mapping)
    # RECORD_LEN defaults - exact values require 파일설명서(.doc) 변환
    LAYOUT_DATA = []
    DEFAULT_LENS = {
        'A': 300, 'B': 1500, 'C': 500, 'D': 500, 'E': 500, 'F': 500,
        'G': 500, 'H': 500, 'I': 500, 'J': 500, 'K': 500, 'L': 500,
        'M': 500, 'N': 500, 'O': 500, 'P': 500, 'Q': 500, 'R': 500,
        'S': 500, 'T': 500, 'U': 500, 'Z': 200
    }
    layout_id = 0
    for fc in FORM_CODE_DATA:
        layout_id += 1
        form_cd, tax_type, form_nm, rec_type = fc[0], fc[1], fc[2], fc[3]
        req_yn = 'Y' if fc[4] in ('Y', 'C') else 'N'  # RECORD_LAYOUT: Y/N only (C→Y)
        rec_len = DEFAULT_LENS.get(rec_type, 500)
        LAYOUT_DATA.append((layout_id, tax_type, form_cd, rec_type, form_nm, rec_len, req_yn, D, None))
    # Build FORM_CD → LAYOUT_ID mapping for FIELD_LAYOUT FK references
    _form_to_layout = {fc[0]: i + 1 for i, fc in enumerate(FORM_CODE_DATA)}

    # =========================================================================
    # Sheet 9: MST_FIELD_LAYOUT (필드 레이아웃 - VAT A/B 레코드 샘플)
    # =========================================================================
    FIELD_HEADERS = [
        'FIELD_ID', 'LAYOUT_ID', 'FIELD_SEQ', 'FIELD_NM', 'FIELD_START',
        'FIELD_LEN', 'DATA_TYPE', 'REQUIRED_TYPE', 'VALID_VALUES',
        'VALIDATION_TYPE', 'DESCRIPTION'
    ]
    # LAYOUT_ID references: V101000 → _form_to_layout['V101000'], V101001 → _form_to_layout['V101001']
    _LID_A = _form_to_layout['V101000']  # VAT A Record header layout
    _LID_B = _form_to_layout['V101001']  # VAT B Record body layout
    FIELD_DATA = [
        # VAT A Record (헤더) - V101000
        (1, _LID_A, 1, '레코드구분', 1, 1, 'C', 'M', '["A"]', None, '헤더 레코드 식별자'),
        (2, _LID_A, 2, '서식코드', 2, 7, 'C', 'M', None, None, '서식코드 (V101001 등)'),
        (3, _LID_A, 3, '사업자등록번호', 9, 10, 'N', 'M', None, 'BRN', '10자리 사업자번호'),
        (4, _LID_A, 4, '납세자명', 19, 40, 'C', 'M', None, None, '납세자(법인)명'),
        (5, _LID_A, 5, '귀속연도', 59, 4, 'N', 'M', None, None, 'YYYY 형식'),
        (6, _LID_A, 6, '귀속기간', 63, 2, 'N', 'M', '["01","02","03","04"]', None, '부가세 귀속기간코드'),
        (7, _LID_A, 7, '신고구분코드', 65, 2, 'N', 'M', '["01","02","03","04"]', None, '정기/수정/기한후/경정'),
        (8, _LID_A, 8, '주민등록번호', 67, 13, 'N', 'M', None, 'RRN', '13자리 주민번호'),
        (9, _LID_A, 9, '프로그램코드', 80, 10, 'C', 'O', None, None, '세무프로그램 식별코드'),
        # VAT B Record (신고서 본문) - V101001 주요 필드
        (10, _LID_B, 1, '레코드구분', 1, 1, 'C', 'M', '["B"]', None, '본문 레코드 식별자'),
        (11, _LID_B, 2, '서식코드', 2, 7, 'C', 'M', None, None, 'V101001'),
        (12, _LID_B, 3, '사업자등록번호', 9, 10, 'N', 'M', None, 'BRN', '10자리 사업자번호'),
        (13, _LID_B, 4, '세금계산서발급분-과세표준', 19, 15, 'N', 'M', None, None, '과세 매출 과세표준'),
        (14, _LID_B, 5, '세금계산서발급분-세액', 34, 13, 'N', 'M', None, None, '= 과세표준 x 10%'),
        (15, _LID_B, 6, '영세율세금계산서-과세표준', 47, 15, 'N', 'O', None, None, '영세율 매출'),
        (16, _LID_B, 7, '과세표준합계', 62, 15, 'N', 'M', None, None, 'SUM(각 유형별 과세표준)'),
        (17, _LID_B, 8, '매출세액합계', 77, 13, 'N', 'M', None, None, 'SUM(각 유형별 세액)'),
        (18, _LID_B, 9, '공제받을매입세액합계', 90, 13, 'N', 'M', None, None, 'SUM(각 매입세액)'),
        (19, _LID_B, 10, '납부(환급)세액', 103, 13, 'N', 'M', None, None, '매출세액-매입세액+불공제'),
        (20, _LID_B, 11, '차가감납부할세액', 116, 13, 'N', 'M', None, None, '최종 납부/환급 세액'),
    ]

    # =========================================================================
    # Create Sheets
    # =========================================================================
    HEADER_FONT = Font(bold=True, size=11)
    HEADER_FILL = PatternFill(start_color='4472C4', end_color='4472C4', fill_type='solid')
    HEADER_FONT_WHITE = Font(bold=True, size=11, color='FFFFFF')
    THIN_BORDER = Border(
        left=Side(style='thin'), right=Side(style='thin'),
        top=Side(style='thin'), bottom=Side(style='thin')
    )

    sheets_config = [
        ('TAX_TYPE', TAX_TYPE_HEADERS, TAX_TYPE_DATA),
        ('FORM_CODE', FORM_CODE_HEADERS, FORM_CODE_DATA),
        ('VALIDATION_RULE', RULE_HEADERS, RULE_DATA),
        ('TAX_RATE', RATE_HEADERS, RATE_DATA),
        ('DEDUCTION_LIMIT', DED_HEADERS, DED_DATA),
        ('CODE', CODE_HEADERS, CODE_DATA),
        ('ERROR_CODE', ERR_HEADERS, ERR_DATA),
        ('RECORD_LAYOUT', LAYOUT_HEADERS, LAYOUT_DATA),
        ('FIELD_LAYOUT', FIELD_HEADERS, FIELD_DATA),
    ]

    for idx, (sheet_name, headers, data) in enumerate(sheets_config):
        if idx == 0:
            ws = wb.active
            ws.title = sheet_name
        else:
            ws = wb.create_sheet(title=sheet_name)

        # Write headers
        for col_idx, header in enumerate(headers, 1):
            cell = ws.cell(row=1, column=col_idx, value=header)
            cell.font = HEADER_FONT_WHITE
            cell.fill = HEADER_FILL
            cell.alignment = Alignment(horizontal='center', vertical='center')
            cell.border = THIN_BORDER

        # Write data
        for row_idx, row_data in enumerate(data, 2):
            for col_idx, value in enumerate(row_data, 1):
                cell = ws.cell(row=row_idx, column=col_idx, value=value)
                cell.border = THIN_BORDER
                if isinstance(value, (int, float)) and value is not None:
                    cell.number_format = '#,##0' if isinstance(value, int) else '#,##0.00'

        # Auto-adjust column widths
        for col_idx, header in enumerate(headers, 1):
            max_len = len(str(header))
            for row_idx in range(2, len(data) + 2):
                val = ws.cell(row=row_idx, column=col_idx).value
                if val is not None:
                    # Approximate: Korean chars count as 2
                    str_val = str(val)
                    char_len = sum(2 if ord(c) > 127 else 1 for c in str_val)
                    max_len = max(max_len, min(char_len, 60))
            ws.column_dimensions[ws.cell(row=1, column=col_idx).column_letter].width = max_len + 4

        # Freeze header row
        ws.freeze_panes = 'A2'
        # Auto filter
        ws.auto_filter.ref = ws.dimensions

    # =========================================================================
    # Save
    # =========================================================================
    script_dir = os.path.dirname(os.path.abspath(__file__))
    output_path = os.path.join(script_dir, 'fev-master-data-init.xlsx')
    wb.save(output_path)

    # Print summary
    print(f"\n{'='*60}")
    print(f"  FEV Master Data Initial Seed - Generated Successfully")
    print(f"{'='*60}")
    print(f"  Output: {output_path}")
    print(f"{'='*60}")
    for sheet_name, headers, data in sheets_config:
        print(f"  {sheet_name:25s} : {len(data):4d} rows x {len(headers)} cols")
    total = sum(len(d) for _, _, d in sheets_config)
    print(f"{'='*60}")
    print(f"  {'TOTAL':25s} : {total:4d} rows")
    print(f"{'='*60}\n")


if __name__ == '__main__':
    main()

# 전자신고 파일 오류검증 - 기능 요구사항 정의서 및 사용자 스토리

> **Summary**: TaxServiceENTEC-FEV 프로젝트의 기능 요구사항, 사용자 스토리, 우선순위 매트릭스, 기능 흐름도를 정의한 문서
>
> **Project**: TaxServiceENTEC-FEV (Tax File Conversion Error Validation)
> **Author**: Product Manager
> **Date**: 2026-02-19
> **Status**: Draft

---

## 목차

1. [기능 요구사항 정의서 (Functional Requirements)](#1-기능-요구사항-정의서)
2. [사용자 스토리 (User Stories)](#2-사용자-스토리)
3. [우선순위 매트릭스 (Priority Matrix)](#3-우선순위-매트릭스)
4. [기능 흐름도 (Feature Flow)](#4-기능-흐름도)

---

## 1. 기능 요구사항 정의서

### 1.1 [FR-001] 전자신고 파일 파서 엔진

#### 개요

국세청 표준 전자신고 파일(고정길이 레코드 기반 텍스트 파일)을 읽어 세목을 식별하고 레코드/필드 단위로 구조화하는 엔진.

#### 상세 기능 목록

| 요구사항 ID | 기능명 | 상세 설명 | 우선순위 |
|------------|--------|---------|---------|
| FR-001-01 | 다중 세목 파일 지원 | `.101`(부가세일반), `.102`(부가세간이), `.201`(법인세), `.301`(종합소득세), `.401`(원천세), `.501`(양도소득세), `.601`(증여세), `.701`(상속세) 확장자별 세목 자동 인식 | P1 |
| FR-001-02 | 인코딩 자동 감지 | EUC-KR / UTF-8 자동 감지 및 내부 변환 처리 | P1 |
| FR-001-03 | 합본 파일 처리 | 다수 거래처 합본 파일을 A~Z 레코드 구조 기준으로 개별 신고건으로 분리 파싱 | P1 |
| FR-001-04 | 대용량 파일 처리 | 100MB 이상 파일의 스트림(Stream) 기반 처리로 메모리 사용 최소화 | P2 |
| FR-001-05 | 다중 파일 동시 처리 | 복수 전자신고 파일 일괄 업로드 및 순차/병렬 처리 지원 | P2 |
| FR-001-06 | 레코드 타입 식별 | 각 라인 첫 바이트(A~Z)로 레코드 타입(헤더/바디/트레일러) 자동 식별 | P1 |
| FR-001-07 | 고정길이 필드 파싱 | 레코드 레이아웃 메타데이터(시작위치+길이)를 기반으로 바이트 단위 필드 추출 | P1 |
| FR-001-08 | 레코드 레이아웃 외부화 | JSON 또는 DB 기반 레코드/필드 정의 관리 (코드 수정 없이 레이아웃 변경 가능) | P1 |
| FR-001-09 | 세목별 파서 플러그인 | Strategy 패턴으로 세목별 파싱 로직 분리, 신규 세목 추가 용이 | P1 |
| FR-001-10 | 바이트 단위 처리 | 한글(EUC-KR 2byte), 영숫자(1byte) 구분을 포함한 정확한 바이트 계산 | P1 |

#### 입력 / 처리 / 출력

| 구분 | 내용 |
|------|------|
| **입력** | 전자신고 파일 (`.101`~`.701`), 파일 인코딩 정보, 레코드 레이아웃 메타데이터(DB/JSON) |
| **처리** | 인코딩 감지 -> 세목 식별 -> 합본 분리 -> 레코드 분리 -> 필드 파싱 -> 구조화 객체 생성 |
| **출력** | 파싱된 레코드 목록 (레코드타입, 필드목록, 필드값, 바이트위치) |

#### 선행조건 / 후행조건

| 구분 | 내용 |
|------|------|
| **선행조건** | 레코드 레이아웃 메타데이터(MST_RECORD_LAYOUT, MST_FIELD_LAYOUT)가 DB에 등록되어 있어야 함 |
| **후행조건** | 파싱 결과가 검증 파이프라인(FR-002)에 전달되어야 함. 파싱 오류 시 오류 결과 즉시 반환 |

#### 비즈니스 규칙

- 문자 필드: 좌측정렬, 우측 공백(0x20) 패딩
- 숫자 필드: 우측정렬, 좌측 '0'(0x30) 패딩
- 날짜: YYYYMMDD 8자리 (하이픈 없음)
- 사업자번호: 10자리 숫자 (하이픈 없음)
- 주민번호: 13자리 숫자 (하이픈 없음)
- 합본 파일은 A~Z 레코드 단위로 신고건 구분

---

### 1.2 [FR-002] 5단계 검증 파이프라인 엔진

#### 개요

파싱된 전자신고 파일 데이터를 L1(형식) -> L2(구조) -> L3(내용) -> L4(논리) -> L5(법규) 5단계 순서로 순차 검증하는 파이프라인 엔진.

#### 상세 기능 목록

**Level 1: 형식검증 (Format Validation)**

| 요구사항 ID | 검증항목 | 검증규칙 | 심각도 |
|------------|---------|---------|--------|
| FR-002-01 | 파일 확장자 검증 | 세목별 지정 확장자 여부 | Fatal |
| FR-002-02 | 파일 인코딩 검증 | 지정 문자셋 일치 여부 | Fatal |
| FR-002-03 | 레코드 길이 검증 | 각 레코드의 바이트 수가 레이아웃 명세와 일치 | Fatal |
| FR-002-04 | 필드 데이터 타입 | 숫자 필드에 문자 포함 여부 | Fatal |
| FR-002-05 | 필드 길이 검증 | 필드 값이 지정 바이트 범위 이내 | Fatal |
| FR-002-06 | 코드값 유효성 | 코드 필드가 허용 코드표(MST_CODE)에 존재 | Fatal |
| FR-002-07 | 날짜 형식 검증 | YYYYMMDD 형식 및 유효 일자 (윤년 포함) | Fatal |
| FR-002-08 | 패딩 규칙 검증 | 문자 우측공백, 숫자 좌측제로 패딩 준수 | Warning |

**Level 2: 구조검증 (Structural Validation)**

| 요구사항 ID | 검증항목 | 검증규칙 | 심각도 |
|------------|---------|---------|--------|
| FR-002-09 | A 레코드 존재 | 헤더 레코드 1건 필수 존재 | Fatal |
| FR-002-10 | Z 레코드 존재 | 트레일러 레코드 1건 필수 존재 | Fatal |
| FR-002-11 | 레코드 순서 | A -> B~Y -> Z 순서 준수 | Fatal |
| FR-002-12 | 레코드 건수 일치 | Z 레코드의 건수 = 실제 데이터 레코드 수 | Fatal |
| FR-002-13 | 필수 레코드 존재 | 세목별 필수 레코드 타입 존재 여부 | Fatal |
| FR-002-14 | 필수 항목 존재 | M(Mandatory) 표시 필드 값 존재 | Fatal |
| FR-002-15 | 조건부 필수 검증 | 특정 조건(예: 면세겸업) 시 연관 필드 필수 여부 | Error |

**Level 3: 내용검증 (Content Validation)**

| 요구사항 ID | 검증항목 | 검증규칙 | 심각도 |
|------------|---------|---------|--------|
| FR-002-16 | 사업자등록번호 체크디지트 | 가중치 [1,3,7,1,3,7,1,3,5] 알고리즘 검증 | Fatal |
| FR-002-17 | 주민등록번호 체크디지트 | 가중치 [2,3,4,5,6,7,8,9,2,3,4,5] 알고리즘 검증 | Fatal |
| FR-002-18 | 법인등록번호 체크디지트 | 가중치 [1,2,1,2,1,2,1,2,1,2,1,2] 알고리즘 검증 | Fatal |
| FR-002-19 | 합계금액 정합성 | 합계 = Σ(개별항목), 허용오차 0원 | Error |
| FR-002-20 | 세액 계산 검증 | 과세표준 x 세율 = 산출세액 | Error |
| FR-002-21 | 단수처리 규칙 | 과세표준 1,000원 미만 절사, 세액 원 미만 절사 | Warning |
| FR-002-22 | 납부세액 계산 | 산출세액 - 공제세액 - 기납부세액 = 납부세액 | Error |

**Level 4: 논리검증 (Logic/Cross-reference Validation)**

| 요구사항 ID | 검증항목 | 검증규칙 | 심각도 |
|------------|---------|---------|--------|
| FR-002-23 | 서식간 금액 일치 | 본문 금액 = 부속명세서 합계 | Error |
| FR-002-24 | 기간 정합성 | 시작일 <= 종료일, 과세기간 범위 | Error |
| FR-002-25 | 상호참조 정합성 | 관련 레코드 간 데이터 일관성 (사업자번호 등) | Error |
| FR-002-26 | 이중신고 검증 | 동일 귀속기간 중복 여부 | Warning |
| FR-002-27 | 전기 대비 연속성 | 이월결손금, 감가상각 누계 등 전기 연속성 | Warning |

**Level 5: 법규검증 (Tax Law Compliance Validation)**

| 요구사항 ID | 검증항목 | 검증규칙 | 심각도 |
|------------|---------|---------|--------|
| FR-002-28 | 세율 구간 적용 | 과세표준별 누진세율 정확 적용 | Error |
| FR-002-29 | 공제/감면 한도 | 법정 공제한도 초과 여부 | Error |
| FR-002-30 | 비과세 요건 | 비과세 적용 요건 충족 여부 (1세대1주택 등) | Warning |
| FR-002-31 | 중과세율 적용 | 다주택, 비사업용토지 등 중과 요건 | Warning |
| FR-002-32 | 최저한세 검증 | 감면 후 세액 >= 과세표준 x 최저한세율 | Error |
| FR-002-33 | 가산세 계산 | 법정 가산세 산출의 정확성 | Warning |

#### 입력 / 처리 / 출력

| 구분 | 내용 |
|------|------|
| **입력** | FR-001 파서 엔진 출력(구조화된 레코드/필드), 검증 규칙 목록(MST_VALIDATION_RULE), 세율표(MST_TAX_RATE), 공제한도표(MST_DEDUCTION_LIMIT) |
| **처리** | L1~L5 순차 검증 실행. Fatal 오류 발생 시 해당 레벨에서 조기 종료 가능 |
| **출력** | 검증 결과 목록 (규칙ID, 심각도, 레코드위치, 필드명, 파일값, 기대값, 오류메시지, 법적근거) |

#### 선행조건 / 후행조건

| 구분 | 내용 |
|------|------|
| **선행조건** | FR-001 파싱 완료. 세율표/공제한도 마스터 데이터가 귀속연도에 맞게 등록되어 있어야 함 |
| **후행조건** | 검증 결과가 RES_VALIDATION_DETAIL 테이블에 저장되고, FR-005 리포팅 엔진에 전달 |

#### 비즈니스 규칙

- 심각도 분류: Fatal(파일 접수 불가) > Error(과세 위험) > Warning(확인 필요) > Info(참고)
- Fatal 오류 존재 시 파일은 홈택스 접수 거부 상태로 판정
- 검증 규칙은 귀속연도 기준으로 유효기간 내 규칙 적용 (APPLY_START_DT ~ APPLY_END_DT)
- 단수처리: 과세표준 1,000원 미만 절사, 산출세액 원 미만 절사, 지방소득세 10원 미만 절사

---

### 1.3 [FR-003] 세목별 전문 검증 모듈

#### 1.3.1 부가가치세 검증 모듈 (상세 구현)

| 요구사항 ID | 기능명 | 검증규칙 요약 | 근거법령 |
|------------|--------|------------|---------|
| VAT-C001 | 과세 매출세액 계산 | 매출세액 = 과세표준 x 10% | 부가가치세법 제30조 |
| VAT-C002 | 영세율 매출세액 | 영세율 매출 세액 = 0원 | 부가가치세법 제11조 |
| VAT-C003 | 과세표준 합계 | 합계 = SUM(세금계산서+신용카드+기타+영세율) | |
| VAT-C004 | 매출세액 합계 | 합계 = SUM(각 유형별 세액) | |
| VAT-C010 | 매입세액 합계 | 공제받을매입세액 = SUM(일반+고정자산+예정누락+기타공제) | 부가가치세법 제37조 |
| VAT-C011 | 불공제 매입세액 | 접대비, 비영업용 승용차 등 불공제 항목 검증 | 부가가치세법 제39조 |
| VAT-C030 | 공통매입세액 안분비율 | 면세비율 = 면세공급가액 / (과세+면세) | 부가가치세법 제40조 |
| VAT-C050 | 납부(환급)세액 | = 매출세액 - 공제받을매입세액 + 불공제매입세액 | |
| VAT-C051 | 차가감납부세액 | = 납부세액 - 경감공제 - 예정미환급 - 예정고지 - 기납부 | |
| VAT-C052 | 신용카드발행공제 한도 | 연간 1,000만원 한도 (일반 1.3%, 음식숙박 2.6%) | |
| VAT-L001 | 매출합계표↔신고서 교차 | C레코드 총공급가액 = B레코드 세금계산서발급분 과세표준 | |
| VAT-L002 | 매출합계표↔신고서 세액 | C레코드 총세액 = B레코드 세금계산서발급분 세액 | |
| VAT-L003 | 매입합계표↔신고서 교차 | E레코드 총공급가액 = B레코드 세금계산서수취분 과세표준 | |
| VAT-L005 | 갑지↔을지 매수 일치 | 갑지 총매수 = SUM(을지 각 거래처 매수) | |
| VAT-R002 | 간이과세 부가가치율 | 업종별 부가가치율 적용 정확성 | |

#### 1.3.2 법인세 검증 모듈 (상세 구현)

| 요구사항 ID | 기능명 | 검증규칙 요약 | 근거법령 |
|------------|--------|------------|---------|
| CIT-C001 | 당기순이익 일치 | 법인세-2 손익계산서 당기순이익 = 법인세-1 세무조정계산서 결산서상 당기순이익 | 법인세법 시행규칙 별지 제3호 |
| CIT-C002 | 소득금액 계산 | = 당기순이익 + 익금산입 + 손금불산입 - 손금산입 - 익금불산입 | 법인세법 제14조 |
| CIT-C003 | 과세표준 계산 | = 소득금액 - 이월결손금 - 비과세소득 | 법인세법 제13조 |
| CIT-C004 | 산출세액 계산 | 4단계 누진세율 적용 (9%/19%/21%/24%) | 법인세법 제55조 |
| CIT-C007 | 이월결손금 한도 | 일반: 소득 x 60%, 중소기업: 100% | 법인세법 제13조 |
| CIT-C009 | 최저한세 검증 | 감면후세액 >= 과세표준 x 최저한세율 | 조특법 제132조 |
| CIT-L001 | 접대비 한도 | 기본한도 + 수입금액 기준 한도 초과 여부 | 법인세법 제25조 |
| CIT-L002 | 기부금 한도 | 법정/지정 기부금 각각 한도 초과 여부 | 법인세법 제24조 |
| CIT2-E001 | 재무상태표 대차균형 | 자산총계 = 부채총계 + 자본총계 | |
| CIT2-E013 | 당기순이익 (손익계산서) | = 법인세비용차감전순이익 - 법인세비용 | |
| CIT2-E020 | 당기순이익 교차검증 | 법인세-2 당기순이익 = 법인세-1 결산서상 당기순이익 | |

#### 1.3.3 종합소득세 검증 모듈 (상세 구현)

| 요구사항 ID | 기능명 | 검증규칙 요약 | 근거법령 |
|------------|--------|------------|---------|
| INC-C001 | 소득합산 | 종합소득금액 = 이자+배당+사업+근로+연금+기타 | |
| INC-C002 | 과세표준 계산 | = 종합소득금액 - 소득공제합계 (1,000원 미만 절사) | |
| INC-C003 | 산출세액 계산 | 8단계 누진세율 적용 (6%~45%) | |
| INC-C004 | 결정세액 계산 | = 산출세액 - 세액공제합계 | |
| INC-L001 | 인적공제 소득요건 | 부양가족 소득금액 <= 100만원 | |
| INC-L003 | 부녀자/한부모 중복 불가 | 동시 적용 불가 (한부모 우선) | |
| INC-L004 | 신용카드 공제한도 | 총급여 구간별 한도 (200만~300만원) | |
| INC-L005 | 소득공제 종합한도 | 2,500만원 초과 여부 | |
| INC-L007 | 경비율 적용 | 업종코드별 고시 단순/기준경비율 일치 | |
| INC-T001 | 세율구간 오류 | 과세표준 대비 적용세율 일치 확인 | |

#### 1.3.4 원천세 검증 모듈 (상세 구현)

| 요구사항 ID | 기능명 | 검증규칙 요약 | 심각도 |
|------------|--------|------------|--------|
| WHT-C001 | 근로소득 소계 | A09 = A01 + A02 + A03 + A04 (인원/지급액/소득세/지방세) | Error |
| WHT-C004 | 지방소득세 계산 | 각 항목 지방소득세 = 소득세 x 10% | Error |
| WHT-C006 | 가감계 합계 | A90 = A09 + A10 + A29 + A49 + A69 + A80 | Error |
| WHT-L001 | 근로소득 인원 교차 | B레코드 A01 인원 = C레코드(간이세액) 건수 | Error |
| WHT-L006 | 총지급액 교차 | B레코드 총지급액 = 지급명세서 합계 | Error |
| WHT-Y001 | 연말정산 근로소득공제 | 총급여 구간별 공제율 적용 정합성 | Error |
| WHT-Y004 | 연말정산 결정세액 | = 산출세액 - 세액공제합계 | Error |

#### 1.3.5 개략적 구현 세목 (양도소득세 / 증여세 / 상속세)

| 요구사항 ID | 검증항목 | 검증규칙 요약 |
|------------|---------|------------|
| FR-003-33 | 양도차익 계산 | = 양도가액 - 취득가액 - 필요경비 |
| FR-003-34 | 장기보유특별공제율 | 보유기간별 공제율 검증 (최대 80%) |
| FR-003-36 | 1세대1주택 비과세 | 보유 2년+, 조정대상지역 거주 2년+, 12억 이하 요건 |
| FR-003-37 | 중과세율 적용 | 1년미만 70%, 다주택 중과 여부 |
| FR-003-38 | 기본공제 | 연 250만원 공제 |

---

### 1.4 [FR-004] 검증 규칙 관리 시스템

#### 상세 기능 목록

| 요구사항 ID | 기능명 | 상세 설명 | 우선순위 |
|------------|--------|---------|---------|
| FR-004-01 | 규칙 외부화 | 검증 규칙(MST_VALIDATION_RULE)을 DB/JSON으로 관리, 코드 수정 없이 변경 가능 | P1 |
| FR-004-02 | 세율표 관리 | 귀속연도별 세율표(MST_TAX_RATE)를 데이터로 관리 (소득세 8단계, 법인세 4단계 등) | P1 |
| FR-004-03 | 공제한도 관리 | 공제/감면 한도(MST_DEDUCTION_LIMIT)를 귀속연도별로 관리 | P1 |
| FR-004-04 | 코드표 관리 | 업종코드, 서식코드, 신고유형코드 등 MST_CODE 관리 | P1 |
| FR-004-05 | 레코드 레이아웃 버전 관리 | 세목별/연도별 레코드 레이아웃(MST_RECORD_LAYOUT, MST_FIELD_LAYOUT) 관리 | P1 |
| FR-004-06 | 규칙 유효기간 관리 | 세법 개정에 따른 규칙의 적용 시작일/종료일(APPLY_START_DT~APPLY_END_DT) 관리 | P1 |
| FR-004-07 | 규칙 이력 관리 | 변경 이력 추적 (HIS_RULE_CHANGE: 변경 전/후 값, 변경 사유) | P2 |

#### 입력 / 처리 / 출력

| 구분 | 내용 |
|------|------|
| **입력** | 관리자 입력(규칙ID, 규칙명, 검증수식, 법적근거, 유효기간, 오류메시지, 수정가이드) |
| **처리** | 규칙 CRUD, 유효기간 검증, 이력 저장, 캐시 갱신 |
| **출력** | 규칙 목록 조회, 특정 귀속연도 기준 유효 규칙 조회 |

#### 선행조건 / 후행조건

| 구분 | 내용 |
|------|------|
| **선행조건** | 관리자 권한 인증 필요 |
| **후행조건** | 규칙 변경 시 캐시 무효화 및 이력 저장 |

---

### 1.5 [FR-005] 검증 결과 리포팅 엔진

#### 상세 기능 목록

| 요구사항 ID | 기능명 | 상세 설명 | 우선순위 |
|------------|--------|---------|---------|
| FR-005-01 | 요약 리포트 | 총 오류건수, 심각도별 분류(Fatal/Error/Warning/Info), 검증 통과/실패 최종 판정 | P1 |
| FR-005-02 | 상세 오류목록 | 오류코드, 오류유형, 위치(레코드/필드/바이트), 파일값, 기대값, 오류메시지 | P1 |
| FR-005-03 | 수정 가이드 | 오류별 구체적 수정 방법 안내 (FIX_GUIDE) | P1 |
| FR-005-04 | 법적 근거 연결 | 각 오류의 관련 법 조항 및 가산세 위험 안내 | P2 |
| FR-005-05 | 심각도 분류 | Fatal(접수불가) / Error(과세위험) / Warning(확인필요) / Info(참고) | P1 |
| FR-005-06 | 거래처별 분리 리포트 | 합본 파일의 경우 거래처별로 분리된 검증 결과 제공 | P2 |
| FR-005-07 | 리포트 출력 형식 | 화면표시(기본), PDF, Excel, JSON 내보내기 | P2 |
| FR-005-08 | 비교 리포트 | 수정 전/후 파일 비교 결과 (오류 감소 확인) | P3 |

#### 입력 / 처리 / 출력

| 구분 | 내용 |
|------|------|
| **입력** | FR-002 검증 파이프라인 출력(오류 목록), 수정 가이드(MST_VALIDATION_RULE.FIX_GUIDE), 법적근거(LEGAL_BASIS) |
| **처리** | 오류 집계, 심각도 분류, 거래처별 분리, 출력 형식 변환 |
| **출력** | 요약 리포트 + 상세 오류목록 + 수정가이드 (화면/PDF/Excel/JSON) |

---

### 1.6 [FR-006] 공통 유틸리티

#### 상세 기능 목록

| 요구사항 ID | 기능명 | 상세 설명 | 우선순위 |
|------------|--------|---------|---------|
| FR-006-01 | 사업자번호 체크디지트 | 가중치 [1,3,7,1,3,7,1,3,5] 알고리즘으로 10자리 유효성 검증 | P1 |
| FR-006-02 | 주민번호 체크디지트 | 가중치 [2,3,4,5,6,7,8,9,2,3,4,5] 알고리즘으로 13자리 유효성 검증 | P1 |
| FR-006-03 | 법인번호 체크디지트 | 가중치 [1,2,1,2,1,2,1,2,1,2,1,2] 알고리즘으로 13자리 유효성 검증 | P1 |
| FR-006-04 | 날짜 유효성 검증 | 윤년 판정, 월별 최대일수, 범위 검증 (YYYYMMDD) | P1 |
| FR-006-05 | 인코딩 변환 | EUC-KR <-> UTF-8 변환, 한글 바이트 계산 | P1 |
| FR-006-06 | 금액 단수처리 | 과세표준 1,000원 미만 절사, 세액 원 미만 절사, 지방소득세 10원 미만 절사 | P1 |
| FR-006-07 | 세율표 조회 | 귀속연도/과세표준 구간별 적용 세율 조회 | P1 |
| FR-006-08 | 보유기간 계산 | 취득일~양도일 연/월/일 단위 계산 (양도소득세용) | P2 |
| FR-006-09 | 개인정보 마스킹 | 주민번호 뒤 6자리 마스킹, 계좌번호 마스킹 | P1 |

---

### 1.7 [FR-007] 파일 뷰어

#### 상세 기능 목록

| 요구사항 ID | 기능명 | 상세 설명 | 우선순위 |
|------------|--------|---------|---------|
| FR-007-01 | 레코드 목록 표시 | 파일 내 레코드를 목록으로 파싱하여 타입(A~Z), 라인번호와 함께 표시 | P2 |
| FR-007-02 | 필드 상세 표시 | 선택 레코드의 필드별 위치(시작~종료 바이트)/값/타입/필수여부 표시 | P2 |
| FR-007-03 | 원시 데이터 표시 | HEX/문자 병렬 표시 (바이트 수준 확인) | P3 |
| FR-007-04 | 오류 위치 하이라이트 | 검증 오류가 있는 필드를 시각적으로 강조 표시 | P2 |
| FR-007-05 | 파일 비교 | 수정 전/후 파일의 차이점 비교 | P3 |

---

### 1.8 [FR-008] 일괄처리

#### 상세 기능 목록

| 요구사항 ID | 기능명 | 상세 설명 | 우선순위 |
|------------|--------|---------|---------|
| FR-008-01 | 다중 파일 일괄 검증 | 복수 전자신고 파일 동시 업로드 및 검증 (최대 100개) | P2 |
| FR-008-02 | 합본 파일 분리 검증 | 합본 파일 내 거래처별 분리 후 개별 검증 실행 | P2 |
| FR-008-03 | 일괄 검증 결과 대시보드 | 전체 통과/실패 현황, 세목별/오류유형별 통계 | P2 |
| FR-008-04 | 오류 거래처 필터링 | 오류가 있는 거래처만 필터링하여 목록 표시 | P2 |

---

### 1.9 비기능 요구사항

| 구분 | 항목 | 기준 |
|------|------|------|
| **성능** | 단일 파일 검증 응답시간 | 10MB 이하: 3초 이내 |
| **성능** | 대용량 파일 처리 | 100MB 이상: 스트림 처리, 30초 이내 |
| **성능** | 일괄 처리 | 100개 파일 동시: 5분 이내 |
| **보안** | 개인정보 마스킹 | 주민번호 뒤 6자리 마스킹 (리포트 출력 시) |
| **보안** | 파일 보관 | 검증 완료 후 원본 파일 즉시 삭제 또는 암호화 보관 |
| **보안** | 접근 제어 | 신청인 이외 검증 결과 접근 불가 |
| **보안** | 로그 보안 | 로그에 개인정보 출력 금지 |
| **확장성** | 세목 추가 | 플러그인 구조로 신규 세목 검증 모듈 추가 용이 |
| **확장성** | 규칙 추가 | DB 기반으로 신규 검증 규칙 코드 변경 없이 추가 |
| **운영** | 감사 로그 | 검증 요청/결과 이력 보관 최소 5년 |
| **운영** | 모니터링 | 검증 건수, 오류율, 처리시간 통계 대시보드 |

---

## 2. 사용자 스토리

### 2.1 세무사 / 세무법인 직원

#### US-TAX-001: 신고파일 제출 전 오류 사전점검

```
As a 세무사로서,
I want 고객의 전자신고 파일을 홈택스 제출 전에 즉시 오류 검증하고 싶다,
So that 홈택스 접수 거부나 과소신고 가산세 위험을 사전에 차단할 수 있다.
```

**인수조건 (Acceptance Criteria)**:
- [ ] 전자신고 파일(.101~.701)을 드래그앤드롭 또는 파일선택으로 업로드할 수 있다
- [ ] 세목이 자동으로 식별되고 확인 화면이 표시된다
- [ ] 5단계(형식/구조/내용/논리/법규) 검증이 순차 실행되고 진행상태가 표시된다
- [ ] 검증 완료 후 30초 이내(10MB 이하 파일 기준 3초 이내)에 결과가 표시된다
- [ ] 결과 요약(Fatal/Error/Warning 건수)이 상단에 즉시 표시된다
- [ ] Fatal 오류가 있으면 "홈택스 접수 불가" 판정이 빨간색으로 표시된다

#### US-TAX-002: 오류 원인 파악 및 수정 가이드 확인

```
As a 세무사로서,
I want 각 오류의 원인(법적 근거 포함)과 수정 방법을 구체적으로 알고 싶다,
So that 세무프로그램에서 정확하게 수정할 수 있고 고객에게 설명할 수 있다.
```

**인수조건**:
- [ ] 오류 항목 클릭 시 상세 정보(오류코드, 오류내용, 파일값, 기대값)가 표시된다
- [ ] 각 오류에 관련 법 조항(예: 부가가치세법 제30조)이 표시된다
- [ ] 각 오류에 가산세 위험(예: 과소신고가산세 10%) 안내가 표시된다
- [ ] 오류별 수정 가이드(구체적 수정 방법)가 표시된다
- [ ] 오류 위치(레코드 타입, 필드명, 바이트 위치)가 정확히 표시된다

#### US-TAX-003: 검증 결과 PDF/Excel 출력

```
As a 세무사로서,
I want 검증 결과를 PDF 또는 Excel로 저장하고 싶다,
So that 고객 상담 자료 또는 세무서 소명 자료로 활용할 수 있다.
```

**인수조건**:
- [ ] 검증 결과 화면에서 PDF 내보내기 버튼을 클릭할 수 있다
- [ ] PDF에 요약(판정결과, 오류건수) 및 상세 오류목록이 포함된다
- [ ] PDF에 법적 근거 및 수정 가이드가 포함된다
- [ ] Excel 내보내기 시 오류목록이 표 형태로 저장된다
- [ ] 파일명에 사업자번호, 세목, 검증일자가 포함된다

#### US-TAX-004: 파일 뷰어로 원시 데이터 확인

```
As a 세무사로서,
I want 전자신고 파일의 레코드/필드 구조를 시각적으로 확인하고 싶다,
So that 세무프로그램 없이도 파일 내용을 직접 검토하고 오류 위치를 확인할 수 있다.
```

**인수조건**:
- [ ] 파일 뷰어에서 레코드 목록(타입, 라인번호)이 표시된다
- [ ] 레코드 선택 시 필드별 (필드명, 위치, 값, 타입)이 테이블로 표시된다
- [ ] 오류가 있는 필드는 빨간색 또는 황색으로 강조 표시된다
- [ ] 주민번호/계좌번호는 자동으로 마스킹 처리된다

---

### 2.2 기장대리 담당자

#### US-BK-001: 대량 신고파일 일괄 검증

```
As a 기장대리 담당자로서,
I want 여러 거래처의 신고파일을 한 번에 업로드하여 일괄 검증하고 싶다,
So that 신고 시즌에 수십~수백 건의 파일을 효율적으로 점검할 수 있다.
```

**인수조건**:
- [ ] 복수 파일(최대 100개)을 동시에 업로드할 수 있다
- [ ] 일괄 검증 진행률이 전체 파일 기준으로 표시된다
- [ ] 검증 완료된 파일은 실시간으로 결과가 업데이트된다
- [ ] 전체 결과 대시보드에서 통과/실패/진행중 현황이 한눈에 보인다
- [ ] 100개 파일 기준 5분 이내에 전체 검증이 완료된다

#### US-BK-002: 합본 파일 거래처별 분리 검증

```
As a 기장대리 담당자로서,
I want 합본 파일(여러 거래처 합산)을 업로드하면 거래처별로 분리하여 검증하고 싶다,
So that 합본 파일 그대로 검증하면서도 각 거래처별 오류를 개별적으로 확인할 수 있다.
```

**인수조건**:
- [ ] 합본 파일 업로드 시 자동으로 거래처별 분리가 이루어진다
- [ ] 분리된 거래처 수가 표시된다
- [ ] 거래처별 검증 결과가 각각 표시된다
- [ ] 특정 거래처의 상세 결과로 이동할 수 있다

#### US-BK-003: 오류 거래처 필터링 및 우선 처리

```
As a 기장대리 담당자로서,
I want 일괄 검증 결과에서 오류가 있는 거래처만 필터링하여 보고 싶다,
So that 많은 거래처 중 수정이 필요한 건을 빠르게 파악하고 우선 처리할 수 있다.
```

**인수조건**:
- [ ] 결과 대시보드에서 "오류 있음" 필터 버튼을 클릭할 수 있다
- [ ] Fatal 오류 / Error / Warning 기준으로 각각 필터링이 가능하다
- [ ] 세목별 필터링이 가능하다
- [ ] 필터링된 결과를 Excel로 내보낼 수 있다

---

### 2.3 세무프로그램 개발사

#### US-DEV-001: API를 통한 파일 검증 연동

```
As a 세무프로그램 개발사로서,
I want RESTful API를 통해 전자신고 파일 검증 기능을 우리 프로그램에 연동하고 싶다,
So that 자체 프로그램에서 생성한 파일의 품질을 자동으로 검증할 수 있다.
```

**인수조건**:
- [ ] 파일 업로드 및 검증 요청 API가 제공된다
- [ ] API 인증은 JWT 토큰 방식으로 제공된다
- [ ] 검증 결과가 JSON 형태로 반환된다
- [ ] API 문서(Swagger/OpenAPI 3.x)가 제공된다
- [ ] 비동기 처리 방식(폴링 또는 웹훅)이 지원된다

#### US-DEV-002: 세목별 검증 규칙 및 오류코드 확인

```
As a 세무프로그램 개발사로서,
I want 세목별 검증 규칙 목록과 오류코드 체계를 조회하고 싶다,
So that 우리 프로그램의 파일 생성 로직을 개선하는 데 참조할 수 있다.
```

**인수조건**:
- [ ] 세목별 검증 규칙 목록 조회 API가 제공된다
- [ ] 각 규칙의 ID, 설명, 심각도, 법적근거, 오류메시지가 포함된다
- [ ] 오류코드 체계(예: VAT-F001~VAT-R004) 문서가 제공된다

---

### 2.4 관리자

#### US-ADM-001: 검증 규칙 등록 및 수정

```
As a 관리자로서,
I want 검증 규칙을 화면에서 직접 등록/수정/비활성화하고 싶다,
So that 세법 개정 시 코드 배포 없이 즉시 검증 규칙을 반영할 수 있다.
```

**인수조건**:
- [ ] 규칙 목록 화면에서 규칙ID, 세목, 레벨, 심각도 기준으로 조회할 수 있다
- [ ] 규칙 등록 시 규칙ID, 세목, 검증수식, 오류메시지, 수정가이드, 법적근거, 유효기간을 입력할 수 있다
- [ ] 규칙 수정 시 변경 전/후 값 및 변경 사유가 이력으로 자동 저장된다
- [ ] 사용여부(USE_YN) 토글로 규칙 활성화/비활성화가 가능하다
- [ ] 특정 귀속연도 기준으로 유효한 규칙 목록을 조회할 수 있다

#### US-ADM-002: 세율표 및 공제한도 관리

```
As a 관리자로서,
I want 귀속연도별 세율표와 공제한도를 등록하고 관리하고 싶다,
So that 매년 세법 개정 시 데이터만 추가하면 검증 로직이 자동으로 반영된다.
```

**인수조건**:
- [ ] 세율표 관리 화면에서 세목/귀속연도별 세율 구간을 등록/수정할 수 있다
- [ ] 소득세 8단계, 법인세 4단계, 최저한세율 등이 각각 관리된다
- [ ] 공제한도 관리 화면에서 항목별/귀속연도별 한도 금액을 등록할 수 있다
- [ ] 의제매입세액 공제율(업종별), 신용카드 공제한도(급여 구간별) 등이 관리된다

#### US-ADM-003: 레코드 레이아웃 버전 관리

```
As a 관리자로서,
I want 세목별/귀속연도별 레코드 레이아웃 메타데이터를 관리하고 싶다,
So that 국세청 파일 규격 변경 시 코드 배포 없이 레이아웃 데이터만 갱신할 수 있다.
```

**인수조건**:
- [ ] 레코드 레이아웃 관리 화면에서 세목/서식코드/레코드타입별 레이아웃을 조회할 수 있다
- [ ] 레이아웃 등록 시 레코드명, 레코드길이, 필수여부, 적용기간을 입력할 수 있다
- [ ] 필드 레이아웃 등록 시 필드명, 시작위치, 길이, 타입, 필수유형, 허용값을 입력할 수 있다
- [ ] 적용기간(APPLY_START_DT~APPLY_END_DT)으로 연도별 레이아웃 버전이 구분된다

#### US-ADM-004: 검증 처리 현황 모니터링

```
As a 관리자로서,
I want 시스템 전체의 검증 처리 현황과 통계를 실시간으로 확인하고 싶다,
So that 시스템 상태를 모니터링하고 오류 패턴을 분석할 수 있다.
```

**인수조건**:
- [ ] 대시보드에서 금일/금주/금월 검증 건수, 통과율, 주요 오류유형이 표시된다
- [ ] 세목별 검증 건수 및 평균 오류율이 차트로 표시된다
- [ ] 처리 지연(임계값 초과) 건 알림이 제공된다
- [ ] 검증 이력(HIS_VALIDATION_LOG)에서 특정 기간, 세목, 사용자 기준으로 조회할 수 있다

---

## 3. 우선순위 매트릭스

### 3.1 MoSCoW 분류

#### Must (반드시 구현 - Phase 1 MVP)

| ID | 기능 | 근거 |
|----|------|------|
| FR-001-01~03, 06~10 | 파일 파서 엔진 핵심 기능 | 시스템 작동의 전제 조건 |
| FR-002-01~22 | L1(형식)/L2(구조)/L3(내용) 검증 | 홈택스 접수 가능 여부 판단에 필수 |
| FR-003 (부가세) | 부가가치세 검증 모듈 | 신고 건수 1위 세목, 시장성 검증 |
| FR-005-01~03, 05 | 요약리포트, 상세오류목록, 수정가이드, 심각도분류 | 검증 결과 없이는 사용 불가 |
| FR-006-01~07, 09 | 공통 유틸리티 (체크디지트, 날짜, 인코딩, 단수처리, 세율조회, 마스킹) | 검증 로직의 핵심 구성요소 |
| FR-004-01~06 | 검증 규칙/세율표/레이아웃 외부화 관리 | 세법 개정 대응을 위한 필수 구조 |

#### Should (중요하지만 Phase 1 이후 - Phase 2)

| ID | 기능 | 근거 |
|----|------|------|
| FR-003 (법인세) | 법인세 검증 모듈 | 신고 건수 2위, 고부가가치 세목 |
| FR-003 (종합소득세) | 종합소득세 검증 모듈 | 개인 납세자 대상 핵심 세목 |
| FR-003 (원천세) | 원천세 검증 모듈 | 월별 신고 빈도 높은 세목 |
| FR-002-23~27 | L4(논리) 검증 | 서식간 교차검증으로 실질 오류 탐지 |
| FR-002-28~33 | L5(법규) 검증 | 세율/공제 한도 법규 준수 검증 |
| FR-001-04~05 | 대용량/다중 파일 처리 | 기장대리 담당자 업무 지원 |
| FR-005-06~07 | 거래처별 분리 리포트, PDF/Excel 출력 | 실무 활용도 향상 |
| FR-004-07 | 규칙 이력 관리 | 감사 추적성 확보 |

#### Could (있으면 좋음 - Phase 3)

| ID | 기능 | 근거 |
|----|------|------|
| FR-003 (양도소득세) | 양도소득세 개략 검증 | 처리 건수 적고 복잡도 높음 |
| FR-007-01~02, 04 | 파일 뷰어 (레코드/필드 표시, 오류 하이라이트) | 전문가용 부가 기능 |
| FR-008-01~04 | 일괄처리 기능 | 대규모 사용자 대상 기능 |
| FR-005-04 | 법적 근거 연결 (가산세 위험 안내) | 사용자 경험 향상 |
| 크로스 세목 검증 | 부가세 매출 <-> 법인세 수입금액 교차 | 고급 검증 기능 |

#### Won't (현재 범위 외 - Phase 4 이후 검토)

| ID | 기능 | 사유 |
|----|------|------|
| AI 오류 패턴 분석 | 머신러닝 기반 오류 예측 | 데이터 축적 후 검토 |
| 세법 개정 자동 감지 | 국세청 RSS/API 자동 연동 | 국세청 API 제공 여부 미확인 |
| 홈택스 직접 접수 연동 | 검증 후 홈택스 직접 제출 | 국세청 보안 정책 제약 |
| 세무프로그램 연동 API | 더존/세무사랑 등 직접 연동 | 라이선스/보안 협의 필요 |
| FR-007-03, 05 | HEX 뷰어, 파일 비교 | 사용 빈도 낮은 전문가 기능 |
| 증여세/상속세 검증 | 개략 구현 세목 | 처리 건수 극소, 복잡도 매우 높음 |

---

### 3.2 Phase별 할당 및 의존성

```
Phase 1: MVP (핵심 엔진 - 부가세 중심)
┌─────────────────────────────────────────────────────────┐
│  FR-004 (규칙/레이아웃 외부화)   ← 모든 기능의 선행 조건   │
│       ↓                                                 │
│  FR-001 (파일 파서 엔진)         ← FR-004 의존           │
│       ↓                                                 │
│  FR-006 (공통 유틸리티)          ← FR-002/003 의존       │
│       ↓                                                 │
│  FR-002 L1~L3 (형식/구조/내용 검증) ← FR-001, FR-006 의존│
│       ↓                                                 │
│  FR-003 VAT (부가가치세 검증)    ← FR-002 의존           │
│       ↓                                                 │
│  FR-005-01~03,05 (기본 리포팅)   ← FR-002, FR-003 의존  │
└─────────────────────────────────────────────────────────┘

Phase 2: 세목 확장
┌─────────────────────────────────────────────────────────┐
│  FR-002 L4~L5 (논리/법규 검증)   ← Phase 1 완료 후       │
│  FR-003 CIT (법인세-1/-2 검증)   ← Phase 1 완료 후       │
│  FR-003 INC (종합소득세 검증)    ← Phase 1 완료 후       │
│  FR-003 WHT (원천세 검증)        ← Phase 1 완료 후       │
│  FR-003 CGT (양도소득세 개략)    ← Phase 1 완료 후       │
│  FR-001-04~05 (대용량/다중 파일) ← Phase 1 완료 후       │
│  FR-005-06~07 (거래처분리/PDF)   ← Phase 1 완료 후       │
│  FR-004-07 (규칙 이력 관리)      ← Phase 1 완료 후       │
└─────────────────────────────────────────────────────────┘

Phase 3: 고도화
┌─────────────────────────────────────────────────────────┐
│  FR-007 (파일 뷰어)              ← Phase 2 완료 후       │
│  FR-008 (일괄처리)               ← Phase 2 완료 후       │
│  FR-005-04 (법적근거 + 가산세)   ← Phase 2 완료 후       │
│  크로스 세목 검증                ← Phase 2 완료 후       │
└─────────────────────────────────────────────────────────┘

Phase 4: 부가가치 기능 (미래 검토)
┌─────────────────────────────────────────────────────────┐
│  AI 기반 오류 패턴 분석 및 예측                          │
│  세법 개정 자동 감지 및 규칙 업데이트 알림               │
│  타 세무프로그램 연동 API 제공                           │
│  홈택스 접수 전 사전검증 시뮬레이션                       │
└─────────────────────────────────────────────────────────┘
```

### 3.3 의존성 관계 정의

| 기능 ID | 선행 의존 기능 | 의존 유형 |
|---------|-------------|---------|
| FR-001 | FR-004 (레이아웃 메타데이터) | 필수 |
| FR-002 L1~L3 | FR-001, FR-006 | 필수 |
| FR-002 L4~L5 | FR-002 L1~L3, FR-004 (세율표/공제한도) | 필수 |
| FR-003 (모든 세목) | FR-002 L1~L3 | 필수 |
| FR-003 CIT (법인세-2 교차) | FR-003 CIT (법인세-1) | 필수 |
| FR-005 | FR-002, FR-003 | 필수 |
| FR-007 | FR-001 | 필수 |
| FR-008 | FR-001, FR-002, FR-005 | 필수 |

---

## 4. 기능 흐름도

### 4.1 주요 유스케이스: 단일 파일 검증

```
[사용자]                    [FEV 시스템]                          [DB]
   │                              │                               │
   │  1. 파일 업로드               │                               │
   │ ────────────────────────────▶│                               │
   │                              │  2. 파일 메타데이터 추출        │
   │                              │  (확장자, 크기, 업로드자)       │
   │                              │                               │
   │                              │  3. 세목 자동 식별              │
   │                              │  (.101=부가세, .301=종소세 등)  │
   │                              │                               │
   │                              │  4. 레코드 레이아웃 로드        │
   │                              │ ──────────────────────────────▶
   │                              │  MST_RECORD_LAYOUT            │
   │                              │  MST_FIELD_LAYOUT             │
   │                              │ ◀──────────────────────────────
   │                              │                               │
   │                              │  5. 인코딩 감지 및 변환         │
   │                              │  (EUC-KR/UTF-8 자동 감지)      │
   │                              │                               │
   │                              │  6. 합본 파일 분리              │
   │                              │  (A~Z 레코드 단위 분리)         │
   │                              │                               │
   │                              │  7. 레코드/필드 파싱            │
   │                              │  (고정길이 바이트 단위)          │
   │                              │                               │
   │  [검증 진행상태 표시]          │  8. L1 형식검증                │
   │ ◀ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│  (확장자/인코딩/길이/타입)      │
   │                              │                               │
   │                              │  9. L2 구조검증                │
   │                              │  (A/Z존재/순서/건수/필수항목)   │
   │                              │                               │
   │                              │  10. L3 내용검증               │
   │                              │  (체크디지트/합계/세액계산)     │
   │                              │                               │
   │                              │  11. L4 논리검증               │
   │                              │  (서식간 교차/기간/중복)        │
   │                              │                               │
   │                              │  12. L5 법규검증               │
   │                              │  (세율/공제한도/최저한세)       │
   │                              │  검증 규칙 조회                │
   │                              │ ──────────────────────────────▶
   │                              │  MST_VALIDATION_RULE          │
   │                              │  MST_TAX_RATE                 │
   │                              │ ◀──────────────────────────────
   │                              │                               │
   │                              │  13. 검증 결과 저장             │
   │                              │ ──────────────────────────────▶
   │                              │  RES_VALIDATION_RESULT        │
   │                              │  RES_VALIDATION_DETAIL        │
   │                              │ ◀──────────────────────────────
   │                              │                               │
   │                              │  14. 리포트 생성               │
   │                              │  (요약 + 상세오류 + 수정가이드) │
   │                              │                               │
   │  15. 검증 결과 표시           │                               │
   │ ◀────────────────────────────│                               │
```

### 4.2 검증 결과 화면 흐름

```
[파일 업로드 화면]
      │
      │ 파일 선택 / 드래그앤드롭
      ▼
[검증 중 화면]
  ├─ 진행률 표시 (L1~L5 단계별)
  └─ 취소 버튼
      │
      ├─ Fatal 오류 발생 ───────────────────────────────────────┐
      │                                                          │
      ▼                                                          ▼
[검증 결과 - 요약 화면]                              [검증 결과 - 접수불가 화면]
  ├─ 판정결과 (통과 / 오류있음 / 접수불가)               ├─ "홈택스 접수 불가" 빨간 배너
  ├─ 심각도별 오류 건수 (Fatal/Error/Warning/Info)        ├─ Fatal 오류 목록 즉시 표시
  ├─ 세목 / 사업자번호 / 귀속기간 정보                    └─ 수정 가이드 링크
  └─ [상세 오류 목록] 탭
      │
      ▼
[오류 상세 목록 화면]
  ├─ 오류 필터 (심각도별, 세목별)
  ├─ 오류 목록 테이블
  │    (오류코드 / 심각도 / 레코드타입 / 필드명 / 파일값 / 기대값 / 오류메시지)
  └─ 오류 항목 클릭
      │
      ▼
[오류 상세 팝업]
  ├─ 오류 설명
  ├─ 수정 가이드
  ├─ 법적 근거 (법 조항)
  └─ 가산세 위험 안내
      │
      ├─ [파일 뷰어] 버튼 클릭
      │
      ▼
[파일 뷰어 화면]
  ├─ 레코드 목록 (타입, 라인번호)
  ├─ 선택 레코드 필드 상세 테이블
  │    (필드명 / 시작-종료 바이트 / 값 / 오류 여부 강조)
  └─ 오류 필드 하이라이트
      │
      ├─ [내보내기] 버튼 클릭
      ▼
[내보내기 선택]
  ├─ PDF 내보내기
  └─ Excel 내보내기
```

### 4.3 일괄처리 유스케이스 흐름

```
[기장대리 담당자]
      │
      │ 복수 파일 업로드 (최대 100개)
      ▼
[일괄 업로드 화면]
  ├─ 파일 목록 표시 (세목 자동 인식)
  └─ [일괄 검증 시작] 버튼
      │
      ▼
[일괄 검증 진행 화면]
  ├─ 전체 진행률 (N/100)
  ├─ 파일별 실시간 상태 (대기/검증중/완료/오류)
  └─ 예상 완료 시간
      │
      ▼
[일괄 검증 결과 대시보드]
  ├─ 전체 통계 (총 파일수 / 통과 / 오류있음 / Fatal)
  ├─ 세목별 현황 차트
  ├─ 파일별 결과 목록 테이블
  │    (파일명 / 세목 / 사업자번호 / 오류건수 / 판정)
  └─ 필터 기능
       ├─ [오류있음만 보기] 버튼
       ├─ [Fatal만 보기] 버튼
       └─ [세목별 필터]
      │
      │ 특정 파일 클릭
      ▼
[단일 파일 검증 결과 화면] (4.2 흐름으로 연결)
```

### 4.4 관리자 규칙 관리 흐름

```
[관리자]
      │
      ▼
[관리자 로그인] ── JWT 인증
      │
      ▼
[관리 메뉴]
  ├─ 검증 규칙 관리
  ├─ 세율표 관리
  ├─ 공제한도 관리
  ├─ 레코드 레이아웃 관리
  └─ 처리 현황 모니터링
      │
      ▼ (검증 규칙 관리 선택)
[규칙 목록 화면]
  ├─ 필터 (세목, 레벨, 심각도, 사용여부)
  ├─ 규칙 목록 테이블
  └─ [신규 규칙 등록] / [수정] / [비활성화] 버튼
      │
      │ 수정 클릭
      ▼
[규칙 수정 화면]
  ├─ 규칙ID (변경불가)
  ├─ 검증수식, 오류메시지, 수정가이드, 법적근거
  ├─ 적용시작일, 적용종료일
  ├─ 변경 사유 입력 (필수)
  └─ [저장] 버튼
      │
      ▼
[변경 이력 자동 저장]
  └─ HIS_RULE_CHANGE 테이블에 변경전/후/사유 기록
```

---

## 5. 관련 문서

| 문서명 | 경로 | 설명 |
|--------|------|------|
| 핵심기능 요구사항서 | `refer-doc/전자신고_파일오류검증_핵심기능_요구사항.md` | 세목별 검증규칙, 데이터모델, 오류코드 상세 |
| 관리기능 요구사항서 | `refer-doc/전자신고_파일오류검증_관리기능_요구사항.md` | DB설계, 코딩표준, 개발환경 고려사항 |

---

## 버전 이력

| 버전 | 날짜 | 변경내용 | 작성자 |
|------|------|---------|--------|
| 1.0 | 2026-02-19 | 최초 작성 (FR-001~008 기능 요구사항, 4개 사용자 유형 스토리, MoSCoW 우선순위, Phase별 로드맵, 기능 흐름도) | Product Manager |
